<!DOCTYPE html>
<html>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="这一系列文章是对项目nightmare进行翻译和学习得来，是自己在学习的过程中的一些记录，可能会有些混乱，不保证文章的内容是正确无误，如果有任何问题欢迎指出。 1.汇编以及反汇编基础1.1 寄存器这里引用CSAPP第三章的一张图  寄存器所占用的字节数大小： 123456789101112131415161718192021+-----------------+---------------+--">
<meta property="og:type" content="article">
<meta property="og:title" content="PWN 入门基础">
<meta property="og:url" content="http://yoursite.com/2021/04/07/pwn-primer-basic/index.html">
<meta property="og:site_name" content="学习记录">
<meta property="og:description" content="这一系列文章是对项目nightmare进行翻译和学习得来，是自己在学习的过程中的一些记录，可能会有些混乱，不保证文章的内容是正确无误，如果有任何问题欢迎指出。 1.汇编以及反汇编基础1.1 寄存器这里引用CSAPP第三章的一张图  寄存器所占用的字节数大小： 123456789101112131415161718192021+-----------------+---------------+--">
<meta property="og:locale">
<meta property="og:image" content="http://yoursite.com/img/pwn/basic/1.png">
<meta property="og:image" content="http://yoursite.com/img/pwn/basic/2.png">
<meta property="og:image" content="http://yoursite.com/img/pwn/basic/3.png">
<meta property="og:image" content="http://yoursite.com/img/pwn/basic/4.png">
<meta property="og:image" content="http://yoursite.com/img/pwn/basic/5.png">
<meta property="og:image" content="http://yoursite.com/img/pwn/basic/6.png">
<meta property="og:image" content="http://yoursite.com/img/pwn/basic/7.png">
<meta property="og:image" content="http://yoursite.com/img/pwn/basic/8.png">
<meta property="article:published_time" content="2021-04-07T14:55:00.000Z">
<meta property="article:modified_time" content="2021-04-07T15:11:25.453Z">
<meta property="article:author" content="lex">
<meta property="article:tag" content="pwn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/img/pwn/basic/1.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>PWN 入门基础</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 5.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/POC/">POC</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2021/04/22/pwn-primer-stack-buffer-overflower-1/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2020/11/22/Exchange-New-Export-Certificate-RCE/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2021/04/07/pwn-primer-basic/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&text=PWN 入门基础"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&title=PWN 入门基础"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&is_video=false&description=PWN 入门基础"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=PWN 入门基础&body=Check out this article: http://yoursite.com/2021/04/07/pwn-primer-basic/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&title=PWN 入门基础"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&title=PWN 入门基础"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&title=PWN 入门基础"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&title=PWN 入门基础"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&name=PWN 入门基础&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://yoursite.com/2021/04/07/pwn-primer-basic/&t=PWN 入门基础"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E6%B1%87%E7%BC%96%E4%BB%A5%E5%8F%8A%E5%8F%8D%E6%B1%87%E7%BC%96%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">1.汇编以及反汇编基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 寄存器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E5%8F%82%E6%95%B0%E7%9A%84%E4%BC%A0%E9%80%92%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 参数的传递方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E6%8C%87%E4%BB%A4"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 指令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mov"><span class="toc-number">1.3.1.</span> <span class="toc-text">mov</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lea"><span class="toc-number">1.3.2.</span> <span class="toc-text">lea</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#add-amp-sub-amp-xor"><span class="toc-number">1.3.3.</span> <span class="toc-text">add &amp; sub &amp; xor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#push-amp-pop"><span class="toc-number">1.3.4.</span> <span class="toc-text">push &amp; pop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jmp-amp-jnz-amp-jz"><span class="toc-number">1.3.5.</span> <span class="toc-text">jmp &amp; jnz &amp; jz</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#call-amp-ret"><span class="toc-number">1.3.6.</span> <span class="toc-text">call &amp; ret</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E6%B1%87%E7%BC%96%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 汇编代码片段</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#helloworld"><span class="toc-number">1.4.1.</span> <span class="toc-text">helloworld</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#if-then"><span class="toc-number">1.4.2.</span> <span class="toc-text">if then</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#loop"><span class="toc-number">1.4.3.</span> <span class="toc-text">loop</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-ELF%E6%96%87%E4%BB%B6%E7%9A%84%E5%AE%89%E5%85%A8%E7%BC%93%E8%A7%A3%E6%8E%AA%E6%96%BD"><span class="toc-number">1.5.</span> <span class="toc-text">1.5 ELF文件的安全缓解措施</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0%E9%A2%98"><span class="toc-number">2.</span> <span class="toc-text">2.逆向练习题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-helithumper-re"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 helithumper_re</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-beleaf-reverse"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 beleaf reverse</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        PWN 入门基础
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">学习记录</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2021-04-07T14:55:00.000Z" itemprop="datePublished">2021-04-07</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/pwn/" rel="tag">pwn</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>这一系列文章是对项目<a href="'https://github.com/guyinatuxedo/nightmare'">nightmare</a>进行翻译和学习得来，是自己在学习的过程中的一些记录，可能会有些混乱，不保证文章的内容是正确无误，如果有任何问题欢迎指出。</p>
<h1 id="1-汇编以及反汇编基础"><a href="#1-汇编以及反汇编基础" class="headerlink" title="1.汇编以及反汇编基础"></a>1.汇编以及反汇编基础</h1><h2 id="1-1-寄存器"><a href="#1-1-寄存器" class="headerlink" title="1.1 寄存器"></a>1.1 寄存器</h2><p>这里引用CSAPP第三章的一张图</p>
<p><img src="/img/pwn/basic/1.png" alt="register"></p>
<p>寄存器所占用的字节数大小：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">+-----------------+---------------+---------------+------------+</span><br><span class="line">| 8 Byte Register | Lower 4 Bytes | Lower 2 Bytes | Lower Byte |</span><br><span class="line">+-----------------+---------------+---------------+------------+</span><br><span class="line">|   rbp           |     ebp       |     bp        |     bpl    |</span><br><span class="line">|   rsp           |     esp       |     sp        |     spl    |</span><br><span class="line">|   rip           |     eip       |               |            |</span><br><span class="line">|   rax           |     eax       |     ax        |     al     |</span><br><span class="line">|   rbx           |     ebx       |     bx        |     bl     |</span><br><span class="line">|   rcx           |     ecx       |     cx        |     cl     |</span><br><span class="line">|   rdx           |     edx       |     dx        |     dl     |</span><br><span class="line">|   rsi           |     esi       |     si        |     sil    |</span><br><span class="line">|   rdi           |     edi       |     di        |     dil    |</span><br><span class="line">|   r8            |     r8d       |     r8w       |     r8b    |</span><br><span class="line">|   r9            |     r9d       |     r9w       |     r9b    |</span><br><span class="line">|   r10           |     r10d      |     r10w      |     r10b   |</span><br><span class="line">|   r11           |     r11d      |     r11w      |     r11b   |</span><br><span class="line">|   r12           |     r12d      |     r12w      |     r12b   |</span><br><span class="line">|   r13           |     r13d      |     r13w      |     r13b   |</span><br><span class="line">|   r14           |     r14d      |     r14w      |     r14b   |</span><br><span class="line">|   r15           |     r15d      |     r15w      |     r15b   |</span><br><span class="line">+-----------------+---------------+---------------+------------+</span><br></pre></td></tr></table></figure>
<p>寄存器中的标志位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">00:     Carry Flag</span><br><span class="line">01:     always 1</span><br><span class="line">02:     Parity Flag</span><br><span class="line">03:     always 0</span><br><span class="line">04:     Adjust Flag</span><br><span class="line">05:     always 0</span><br><span class="line">06:     Zero Flag</span><br><span class="line">07:     Sign Flag</span><br><span class="line">08:     Trap Flag</span><br><span class="line">09:     Interruption Flag     </span><br><span class="line">10:     Direction Flag</span><br><span class="line">11:     Overflow Flag</span><br><span class="line">12:     I&#x2F;O Privilege Field lower bit</span><br><span class="line">13:     I&#x2F;O Privilege Field higher bit</span><br><span class="line">14:     Nested Task Flag</span><br><span class="line">15:     Resume Flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">其余的flags可以下面网址获取：</span><br><span class="line">https:&#x2F;&#x2F;en.wikibooks.org&#x2F;wiki&#x2F;X86_Assembly&#x2F;X86_Architecture</span><br></pre></td></tr></table></figure>
<h2 id="1-2-参数的传递方式"><a href="#1-2-参数的传递方式" class="headerlink" title="1.2 参数的传递方式"></a>1.2 参数的传递方式</h2><p>在X86中，参数通过栈来传递；在X64中，则通过寄存器来传递，如果参数过多，第6个参数之后的都通过栈来传递。如下图所示：</p>
<p><img src="/img/pwn/basic/2.png" alt="parameters"></p>
<h2 id="1-3-指令"><a href="#1-3-指令" class="headerlink" title="1.3 指令"></a>1.3 指令</h2><h3 id="mov"><a href="#mov" class="headerlink" title="mov"></a>mov</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov rax, rdx    &#x2F;&#x2F;rax &#x3D; rax + rdx</span><br><span class="line">mov rax, [rdx]  &#x2F;&#x2F;rdx地址指向的值赋值给rax   []表示地址</span><br><span class="line">mov [rax], rdx  &#x2F;&#x2F;把rdx的值赋值给rax地址指向的值，rax寄存器中的值不变</span><br></pre></td></tr></table></figure>
<h3 id="lea"><a href="#lea" class="headerlink" title="lea"></a>lea</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lea指令计算第二个操作数的地址，并把地址赋值给第一个操作数</span><br><span class="line"></span><br><span class="line">lea rdi, [rbx+0x10]     &#x2F;&#x2F;把rbx+0x10的地址赋值到rdi</span><br></pre></td></tr></table></figure>
<h3 id="add-amp-sub-amp-xor"><a href="#add-amp-sub-amp-xor" class="headerlink" title="add &amp; sub &amp; xor"></a>add &amp; sub &amp; xor</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">add rax, rdx    &#x2F;&#x2F; rax &#x3D; rax + rdx</span><br><span class="line">sub rsp, 0x10   &#x2F;&#x2F; rsp &#x3D; rsp - x010</span><br><span class="line">xor rdx, rax    &#x2F;&#x2F; rdx &#x3D; rdx ^ rax</span><br></pre></td></tr></table></figure>
<h3 id="push-amp-pop"><a href="#push-amp-pop" class="headerlink" title="push &amp; pop"></a>push &amp; pop</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">入栈与出栈</span><br><span class="line"></span><br><span class="line">push rax    &#x2F;&#x2F;把rax寄存器保存的内容入栈，保存在栈顶</span><br><span class="line">pop rax     &#x2F;&#x2F;出栈，栈顶的8个字节将以rax寄存器结尾</span><br><span class="line">&#x2F;&#x2F;x86中入栈出栈为4 bytes，x64为8 bytes</span><br></pre></td></tr></table></figure>
<h3 id="jmp-amp-jnz-amp-jz"><a href="#jmp-amp-jnz-amp-jz" class="headerlink" title="jmp &amp; jnz &amp; jz"></a>jmp &amp; jnz &amp; jz</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jmp 0x12345     &#x2F;&#x2F;jump to 0x12345</span><br><span class="line">jnz     &#x2F;&#x2F;jump if not zero</span><br><span class="line">jz      &#x2F;&#x2F;jump if zero</span><br></pre></td></tr></table></figure>
<h3 id="call-amp-ret"><a href="#call-amp-ret" class="headerlink" title="call &amp; ret"></a>call &amp; ret</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">和jmp类似，不同的是会把rbp 和 rip寄存器的值push到栈中，然后调到指定的地址，常用于函数调用，在函数调用完成后，ret指令会被调用，然后弹出入栈的值rbp, rip，可以在中断处继续执行。</span><br></pre></td></tr></table></figure>
<h2 id="1-4-汇编代码片段"><a href="#1-4-汇编代码片段" class="headerlink" title="1.4 汇编代码片段"></a>1.4 汇编代码片段</h2><h3 id="helloworld"><a href="#helloworld" class="headerlink" title="helloworld"></a>helloworld</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function main:</span><br><span class="line">   0x080483fb &lt;+0&gt;: lea    ecx,[esp+0x4]</span><br><span class="line">   0x080483ff &lt;+4&gt;: and    esp,0xfffffff0</span><br><span class="line">   0x08048402 &lt;+7&gt;: push   DWORD PTR [ecx-0x4]</span><br><span class="line">   0x08048405 &lt;+10&gt;:    push   ebp</span><br><span class="line">   0x08048406 &lt;+11&gt;:    mov    ebp,esp</span><br><span class="line">   0x08048408 &lt;+13&gt;:    push   ecx</span><br><span class="line">   0x08048409 &lt;+14&gt;:    sub    esp,0x4</span><br><span class="line">   0x0804840c &lt;+17&gt;:    sub    esp,0xc</span><br><span class="line">   0x0804840f &lt;+20&gt;:    push   0x80484b0</span><br><span class="line">   0x08048414 &lt;+25&gt;:    call   0x80482d0 &lt;puts@plt&gt;</span><br><span class="line">   0x08048419 &lt;+30&gt;:    add    esp,0x10</span><br><span class="line">   0x0804841c &lt;+33&gt;:    mov    eax,0x0</span><br><span class="line">   0x08048421 &lt;+38&gt;:    mov    ecx,DWORD PTR [ebp-0x4]</span><br><span class="line">   0x08048424 &lt;+41&gt;:    leave  </span><br><span class="line">   0x08048425 &lt;+42&gt;:    lea    esp,[ecx-0x4]</span><br><span class="line">   0x08048428 &lt;+45&gt;:    ret    </span><br><span class="line">End of assembler dump.</span><br><span class="line"></span><br><span class="line">; 上面的没有什么特别的操作，主要就是调用了一个puts函数</span><br><span class="line"></span><br><span class="line">0x0804840f &lt;+20&gt;:   push   0x80484b0</span><br><span class="line">0x08048414 &lt;+25&gt;:   call   0x80482d0 &lt;puts@plt&gt;</span><br></pre></td></tr></table></figure>
<h3 id="if-then"><a href="#if-then" class="headerlink" title="if then"></a>if then</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">gdb-peda$ disassemble main </span><br><span class="line">Dump of assembler code for function main:</span><br><span class="line">   0x080483fb &lt;+0&gt;: lea    ecx,[esp+0x4]</span><br><span class="line">   0x080483ff &lt;+4&gt;: and    esp,0xfffffff0</span><br><span class="line">   0x08048402 &lt;+7&gt;: push   DWORD PTR [ecx-0x4]</span><br><span class="line">   0x08048405 &lt;+10&gt;:    push   ebp</span><br><span class="line">   0x08048406 &lt;+11&gt;:    mov    ebp,esp</span><br><span class="line">   0x08048408 &lt;+13&gt;:    push   ecx</span><br><span class="line">   0x08048409 &lt;+14&gt;:    sub    esp,0x14</span><br><span class="line">   0x0804840c &lt;+17&gt;:    mov    DWORD PTR [ebp-0xc],0xa</span><br><span class="line">   0x08048413 &lt;+24&gt;:    cmp    DWORD PTR [ebp-0xc],0xa</span><br><span class="line">   0x08048417 &lt;+28&gt;:    jne    0x8048429 &lt;main+46&gt;</span><br><span class="line">   0x08048419 &lt;+30&gt;:    sub    esp,0xc</span><br><span class="line">   0x0804841c &lt;+33&gt;:    push   0x80484c0</span><br><span class="line">   0x08048421 &lt;+38&gt;:    call   0x80482d0 &lt;puts@plt&gt;</span><br><span class="line">   0x08048426 &lt;+43&gt;:    add    esp,0x10</span><br><span class="line">   0x08048429 &lt;+46&gt;:    mov    eax,0x0</span><br><span class="line">   0x0804842e &lt;+51&gt;:    mov    ecx,DWORD PTR [ebp-0x4]</span><br><span class="line">   0x08048431 &lt;+54&gt;:    leave  </span><br><span class="line">   0x08048432 &lt;+55&gt;:    lea    esp,[ecx-0x4]</span><br><span class="line">   0x08048435 &lt;+58&gt;:    ret    </span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>首先给ebp-0xc地址的值赋值为0xa</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov    DWORD PTR [ebp-0xc],0xa</span><br></pre></td></tr></table></figure>
<p>然后再进行比较，判断该值是否等于0xa，如果不相等，则跳转到main+46这个位置，但是刚刚才做了赋值操作，所以jne这个跳转不会发生</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x08048413 &lt;+24&gt;:   cmp    DWORD PTR [ebp-0xc],0xa</span><br><span class="line">0x08048417 &lt;+28&gt;:   jne    0x8048429 &lt;main+46&gt;</span><br></pre></td></tr></table></figure>
<p>然后调用puts函数，输出结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0x08048419 &lt;+30&gt;:   sub    esp,0xc</span><br><span class="line">0x0804841c &lt;+33&gt;:   push   0x80484c0</span><br><span class="line">0x08048421 &lt;+38&gt;:   call   0x80482d0 &lt;puts@plt&gt;</span><br></pre></td></tr></table></figure>
<h3 id="loop"><a href="#loop" class="headerlink" title="loop"></a>loop</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">gdb-peda$ disassemble main </span><br><span class="line">Dump of assembler code for function main:</span><br><span class="line">   0x080483fb &lt;+0&gt;: lea    ecx,[esp+0x4]</span><br><span class="line">   0x080483ff &lt;+4&gt;: and    esp,0xfffffff0</span><br><span class="line">   0x08048402 &lt;+7&gt;: push   DWORD PTR [ecx-0x4]</span><br><span class="line">   0x08048405 &lt;+10&gt;:    push   ebp</span><br><span class="line">   0x08048406 &lt;+11&gt;:    mov    ebp,esp</span><br><span class="line">   0x08048408 &lt;+13&gt;:    push   ecx</span><br><span class="line">   0x08048409 &lt;+14&gt;:    sub    esp,0x14</span><br><span class="line">   0x0804840c &lt;+17&gt;:    mov    DWORD PTR [ebp-0xc],0x0</span><br><span class="line">   0x08048413 &lt;+24&gt;:    jmp    0x804842c &lt;main+49&gt;</span><br><span class="line">   0x08048415 &lt;+26&gt;:    sub    esp,0x8</span><br><span class="line">   0x08048418 &lt;+29&gt;:    push   DWORD PTR [ebp-0xc]</span><br><span class="line">   0x0804841b &lt;+32&gt;:    push   0x80484c0</span><br><span class="line">   0x08048420 &lt;+37&gt;:    call   0x80482d0 &lt;printf@plt&gt;</span><br><span class="line">   0x08048425 &lt;+42&gt;:    add    esp,0x10</span><br><span class="line">   0x08048428 &lt;+45&gt;:    add    DWORD PTR [ebp-0xc],0x1</span><br><span class="line">   0x0804842c &lt;+49&gt;:    cmp    DWORD PTR [ebp-0xc],0x13</span><br><span class="line">   0x08048430 &lt;+53&gt;:    jle    0x8048415 &lt;main+26&gt;</span><br><span class="line">   0x08048432 &lt;+55&gt;:    mov    eax,0x0</span><br><span class="line">   0x08048437 &lt;+60&gt;:    mov    ecx,DWORD PTR [ebp-0x4]</span><br><span class="line">   0x0804843a &lt;+63&gt;:    leave  </span><br><span class="line">   0x0804843b &lt;+64&gt;:    lea    esp,[ecx-0x4]</span><br><span class="line">   0x0804843e &lt;+67&gt;:    ret    </span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>首先在栈上申请了一个变量ebp-0xc，值为0x0，然后jmp跳到（0x804842c）main+49</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x0804840c &lt;+17&gt;:   mov    DWORD PTR [ebp-0xc],0x0</span><br><span class="line">0x08048413 &lt;+24&gt;:   jmp    0x804842c &lt;main+49&gt;</span><br></pre></td></tr></table></figure>
<p>接着进行判断，比较ebp-0xc 和 0x13，如果小于0x13, 则跳转到 0x8048415 &lt;main+26&gt;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x0804842c &lt;+49&gt;:   cmp    DWORD PTR [ebp-0xc],0x13</span><br><span class="line">0x08048430 &lt;+53&gt;:   jle    0x8048415 &lt;main+26&gt;</span><br></pre></td></tr></table></figure>
<p>跟进到main+26</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0x08048415 &lt;+26&gt;:   sub    esp,0x8</span><br><span class="line">0x08048418 &lt;+29&gt;:   push   DWORD PTR [ebp-0xc]</span><br><span class="line">0x0804841b &lt;+32&gt;:   push   0x80484c0</span><br><span class="line">0x08048420 &lt;+37&gt;:   call   0x80482d0 &lt;printf@plt&gt;</span><br><span class="line">0x08048425 &lt;+42&gt;:   add    esp,0x10</span><br><span class="line">0x08048428 &lt;+45&gt;:   add    DWORD PTR [ebp-0xc],0x1</span><br></pre></td></tr></table></figure>
<p>给栈上分配一个空间，并且用printf函数以某种格式输出ebp-0xc的内容，然后ebp-0xc += 0x1，接着就继续进行判断，整个过程就是一个for循环，伪代码大概如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">int i &#x3D; 0;</span><br><span class="line">for (i &#x3D; 0; i &lt; 20; i++)</span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;%d&quot;, i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="1-5-ELF文件的安全缓解措施"><a href="#1-5-ELF文件的安全缓解措施" class="headerlink" title="1.5 ELF文件的安全缓解措施"></a>1.5 ELF文件的安全缓解措施</h2><pre><code>1. RELRO: 有partial RELRO和FULL RELRO, 如果开启，则无法修改got表
2. Stack： 如果栈中开启Canary found，就不能用直接溢出的方法覆盖栈中返回地址，而且要通过改写指针与局部变量，leak canary， overwrite canary的方法来绕过
3. NX： NX enabled 如果这个保护开启就意味着栈中数据没有执行权限，以前的经常用的call esp或者jmp esp方法就不能用，但是可以利用rop这种方法绕过
4.PIE：PIE enabled 如果程序开启地址随机号，就意味着程序每次运行的时候地址都会变化，而如果没有开启PIE，那么No PIE (0x400000)，括号内的数据就是程序的基地址</code></pre>
<h1 id="2-逆向练习题"><a href="#2-逆向练习题" class="headerlink" title="2.逆向练习题"></a>2.逆向练习题</h1><h2 id="2-1-helithumper-re"><a href="#2-1-helithumper-re" class="headerlink" title="2.1 helithumper_re"></a>2.1 helithumper_re</h2><p>首先运行程序，没什么特别的地方，只是要求我们输入flag。使用IDA查看程序</p>
<p><img src="/img/pwn/basic/3.png" alt="re1"></p>
<p>可以看得到，调用了validate函数判断用户的输入是否正确，跟进validate</p>
<p><img src="/img/pwn/basic/4.png" alt="re2"></p>
<p>从上面代码中可以看出，如果a1[i] != <em>(&amp;v4 + i)，则会退出。</em>(&amp;v4 + i) 分别对应变量v5, v6, v7 …. v17，所以只要循环输出v4 – v17即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a &#x3D; [102,108,97,103,123,72,117,67,102,95,108,65,98,125]</span><br><span class="line">&gt;&gt;&gt; for i in a:</span><br><span class="line">...     print chr(i),</span><br><span class="line">... </span><br><span class="line">f l a g &#123; H u C f _ l A b &#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-2-beleaf-reverse"><a href="#2-2-beleaf-reverse" class="headerlink" title="2.2 beleaf reverse"></a>2.2 beleaf reverse</h2><p>直接使用IDA反汇编，得到源码</p>
<p><img src="/img/pwn/basic/5.png" alt="re3"></p>
<p>代码的关键点在sub_7FA(s[i] != qword_2014E0[i])，从代码中可以看出flag的长度不能小于0x20，查看qword_2014E0这个数组对应的值：</p>
<p><img src="/img/pwn/basic/6.png" alt="re4"></p>
<p>可以看到数组里面的值为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1, 9, 0x11, 0x27, 2, 0, 0x12, 3, 8, 0x12, 9, 0x12, 0x11, 1, 3, 0x13, 4, 3, 5, 0x15, 0x2e, 0x1, 3, 0xa, 0x12, 3, 1, 0x2e, 0x16, 0x2e, 0xa, 0x12, 6]</span><br></pre></td></tr></table></figure>
<p>然后我们再看看sub_7FA函数是怎么处理输入的字符串</p>
<p><img src="/img/pwn/basic/7.png" alt="re5"></p>
<p>从代码中看到，关键点在于</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if ( a1 &#x3D;&#x3D; *((_DWORD *)&amp;off_201020 + v2) )</span><br><span class="line">      return v2;</span><br></pre></td></tr></table></figure>
<p>也就是返回的v2的值要一一对应qword_2014E0数组的值，也就是说v2的第一次返回值必须是1，第二次必须是9，所以输入的a1第一个值为a1 == *((_DWORD *)&amp;off_201020 + 1，第二个值为a1 == *((_DWORD *)&amp;off_201020 + 9。接着查看off_201020数组(v2在这里是index)所对应的值是哪些</p>
<p><img src="/img/pwn/basic/8.png" alt="re8"></p>
<p>从上面可以看出，对应的值分别是0x77, 0x66, 0x7b, 0x5f, 0x6e, 0x79, 0x7d, 0xffffffff, 0x62, 0x6c, 0x72, 0xffffffff, 0xffffffff, …..</p>
<p>所以可以得出以下POC</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">values &#x3D; [0x77,0x66,0x7b,0x5f,0x6e,0x79,0x7d,0xffffffff,0x62,0x6c,0x72,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0x61,0x65,0x69,0xffffffff,0x6f,0x74,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0x67,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0x75,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0xffffffff,0x00]</span><br><span class="line">wanted &#x3D; [0x01,0x09,0x11,0x27,0x02,0x00,0x12,0x03,0x08,0x12,0x09,0x12,0x11,0x01,0x03,0x13,0x04,0x03,0x05,0x15,0x2e,0x0a,0x03,0x0a,0x12,0x03,0x01,0x2e,0x16,0x2e,0x0a,0x12,0x06,]</span><br><span class="line">flag &#x3D; &#39;&#39;</span><br><span class="line"></span><br><span class="line">for i in wanted:</span><br><span class="line">    flag +&#x3D; chr(values[i])</span><br><span class="line"></span><br><span class="line">print flag</span><br></pre></td></tr></table></figure>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/POC/">POC</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E6%B1%87%E7%BC%96%E4%BB%A5%E5%8F%8A%E5%8F%8D%E6%B1%87%E7%BC%96%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">1.汇编以及反汇编基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 寄存器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E5%8F%82%E6%95%B0%E7%9A%84%E4%BC%A0%E9%80%92%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 参数的传递方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E6%8C%87%E4%BB%A4"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 指令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mov"><span class="toc-number">1.3.1.</span> <span class="toc-text">mov</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lea"><span class="toc-number">1.3.2.</span> <span class="toc-text">lea</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#add-amp-sub-amp-xor"><span class="toc-number">1.3.3.</span> <span class="toc-text">add &amp; sub &amp; xor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#push-amp-pop"><span class="toc-number">1.3.4.</span> <span class="toc-text">push &amp; pop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jmp-amp-jnz-amp-jz"><span class="toc-number">1.3.5.</span> <span class="toc-text">jmp &amp; jnz &amp; jz</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#call-amp-ret"><span class="toc-number">1.3.6.</span> <span class="toc-text">call &amp; ret</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E6%B1%87%E7%BC%96%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 汇编代码片段</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#helloworld"><span class="toc-number">1.4.1.</span> <span class="toc-text">helloworld</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#if-then"><span class="toc-number">1.4.2.</span> <span class="toc-text">if then</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#loop"><span class="toc-number">1.4.3.</span> <span class="toc-text">loop</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-ELF%E6%96%87%E4%BB%B6%E7%9A%84%E5%AE%89%E5%85%A8%E7%BC%93%E8%A7%A3%E6%8E%AA%E6%96%BD"><span class="toc-number">1.5.</span> <span class="toc-text">1.5 ELF文件的安全缓解措施</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0%E9%A2%98"><span class="toc-number">2.</span> <span class="toc-text">2.逆向练习题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-helithumper-re"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 helithumper_re</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-beleaf-reverse"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 beleaf reverse</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2021/04/07/pwn-primer-basic/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&text=PWN 入门基础"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&title=PWN 入门基础"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&is_video=false&description=PWN 入门基础"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=PWN 入门基础&body=Check out this article: http://yoursite.com/2021/04/07/pwn-primer-basic/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&title=PWN 入门基础"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&title=PWN 入门基础"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&title=PWN 入门基础"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&title=PWN 入门基础"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2021/04/07/pwn-primer-basic/&name=PWN 入门基础&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://yoursite.com/2021/04/07/pwn-primer-basic/&t=PWN 入门基础"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2021
    lex
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/POC/">POC</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
